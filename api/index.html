
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python package for emulating the TOV equations using the Star Log-extended eMulation (SLM) method.">
      
      
        <meta name="author" content="Sudhanva Lalit, Alexandra C. Semposki, and Joshua M. Maldonado">
      
      
        <link rel="canonical" href="https://asemposki.github.io/SLM/api/">
      
      
        <link rel="prev" href="../examples/">
      
      
        <link rel="next" href="../tutorials/TOV_code/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>API Reference - Star Log-extended eMulation Documentation (SLM)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
      <link rel="stylesheet" href="../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Star Log-extended eMulation Documentation (SLM)" class="md-header__button md-logo" aria-label="Star Log-extended eMulation Documentation (SLM)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Star Log-extended eMulation Documentation (SLM)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/asemposki/SLM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    asemposki/SLM
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
  
  Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tutorials/TOV_code/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../contributing/" class="md-tabs__link">
          
  
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../authors/" class="md-tabs__link">
          
  
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Star Log-extended eMulation Documentation (SLM)" class="md-nav__button md-logo" aria-label="Star Log-extended eMulation Documentation (SLM)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Star Log-extended eMulation Documentation (SLM)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/asemposki/SLM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    asemposki/SLM
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing with this file.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#slmemulator-package-overview" class="md-nav__link">
    <span class="md-ellipsis">
      slmemulator Package Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator" class="md-nav__link">
    <span class="md-ellipsis">
      slmemulator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.ParametricSLM" class="md-nav__link">
    <span class="md-ellipsis">
      ParametricSLM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParametricSLM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slmemulator.ParametricSLM.augment_data" class="md-nav__link">
    <span class="md-ellipsis">
      augment_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.ParametricSLM.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.ParametricSLM.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.augment_data_multiple_columns" class="md-nav__link">
    <span class="md-ellipsis">
      augment_data_multiple_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.clean_directory" class="md-nav__link">
    <span class="md-ellipsis">
      clean_directory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.gaussian_rbf" class="md-nav__link">
    <span class="md-ellipsis">
      gaussian_rbf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.is_on_boundary" class="md-nav__link">
    <span class="md-ellipsis">
      is_on_boundary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.plot_S" class="md-nav__link">
    <span class="md-ellipsis">
      plot_S
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.plot_eigs" class="md-nav__link">
    <span class="md-ellipsis">
      plot_eigs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.plot_parametric" class="md-nav__link">
    <span class="md-ellipsis">
      plot_parametric
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.plot_parametric_old" class="md-nav__link">
    <span class="md-ellipsis">
      plot_parametric_old
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.plot_slm" class="md-nav__link">
    <span class="md-ellipsis">
      plot_slm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.plot_slm_rad" class="md-nav__link">
    <span class="md-ellipsis">
      plot_slm_rad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.recombination_thinning" class="md-nav__link">
    <span class="md-ellipsis">
      recombination_thinning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.solve_tov" class="md-nav__link">
    <span class="md-ellipsis">
      solve_tov
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-slm" class="md-nav__link">
    <span class="md-ellipsis">
      Module: SLM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.SLM" class="md-nav__link">
    <span class="md-ellipsis">
      SLM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.SLM.SLM" class="md-nav__link">
    <span class="md-ellipsis">
      SLM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.SLM.augment_data_multiple_columns" class="md-nav__link">
    <span class="md-ellipsis">
      augment_data_multiple_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.SLM.solve_tov" class="md-nav__link">
    <span class="md-ellipsis">
      solve_tov
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-cleandata" class="md-nav__link">
    <span class="md-ellipsis">
      Module: cleanData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.cleanData" class="md-nav__link">
    <span class="md-ellipsis">
      cleanData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.cleanData.clean_directory" class="md-nav__link">
    <span class="md-ellipsis">
      clean_directory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-config" class="md-nav__link">
    <span class="md-ellipsis">
      Module: config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.config.get_paths" class="md-nav__link">
    <span class="md-ellipsis">
      get_paths
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-pslm" class="md-nav__link">
    <span class="md-ellipsis">
      Module: pSLM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.pSLM" class="md-nav__link">
    <span class="md-ellipsis">
      pSLM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.pSLM.ParametricSLM" class="md-nav__link">
    <span class="md-ellipsis">
      ParametricSLM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParametricSLM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slmemulator.pSLM.ParametricSLM.augment_data" class="md-nav__link">
    <span class="md-ellipsis">
      augment_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.pSLM.ParametricSLM.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.pSLM.ParametricSLM.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.pSLM.is_on_boundary" class="md-nav__link">
    <span class="md-ellipsis">
      is_on_boundary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-recombination" class="md-nav__link">
    <span class="md-ellipsis">
      Module: recombination
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.recombination" class="md-nav__link">
    <span class="md-ellipsis">
      recombination
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.recombination.gaussian_rbf" class="md-nav__link">
    <span class="md-ellipsis">
      gaussian_rbf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.recombination.recombination_thinning" class="md-nav__link">
    <span class="md-ellipsis">
      recombination_thinning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-scaledtov" class="md-nav__link">
    <span class="md-ellipsis">
      Module: scaledTOV
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.scaledTOV" class="md-nav__link">
    <span class="md-ellipsis">
      scaledTOV
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.scaledTOV.TOV" class="md-nav__link">
    <span class="md-ellipsis">
      TOV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TOV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slmemulator.scaledTOV.TOV.RK4" class="md-nav__link">
    <span class="md-ellipsis">
      RK4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.scaledTOV.TOV.baryon_from_energy" class="md-nav__link">
    <span class="md-ellipsis">
      baryon_from_energy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.scaledTOV.TOV.energy_from_pressure" class="md-nav__link">
    <span class="md-ellipsis">
      energy_from_pressure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.scaledTOV.TOV.pressure_from_energy" class="md-nav__link">
    <span class="md-ellipsis">
      pressure_from_energy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.scaledTOV.TOV.pressure_from_nb" class="md-nav__link">
    <span class="md-ellipsis">
      pressure_from_nb
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Module: scripts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.scripts" class="md-nav__link">
    <span class="md-ellipsis">
      scripts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.scripts.curve_plus_bands_plot" class="md-nav__link">
    <span class="md-ellipsis">
      curve_plus_bands_plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.scripts.fermi_momentum" class="md-nav__link">
    <span class="md-ellipsis">
      fermi_momentum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.scripts.lighten_color" class="md-nav__link">
    <span class="md-ellipsis">
      lighten_color
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.scripts.setup_rc_params" class="md-nav__link">
    <span class="md-ellipsis">
      setup_rc_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-tov_class" class="md-nav__link">
    <span class="md-ellipsis">
      Module: TOV_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.TOV_class" class="md-nav__link">
    <span class="md-ellipsis">
      TOV_class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV" class="md-nav__link">
    <span class="md-ellipsis">
      TOV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TOV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.RK2" class="md-nav__link">
    <span class="md-ellipsis">
      RK2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.RK4" class="md-nav__link">
    <span class="md-ellipsis">
      RK4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.canonical_NS_radius" class="md-nav__link">
    <span class="md-ellipsis">
      canonical_NS_radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.central_dens" class="md-nav__link">
    <span class="md-ellipsis">
      central_dens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.euler" class="md-nav__link">
    <span class="md-ellipsis">
      euler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.f_x" class="md-nav__link">
    <span class="md-ellipsis">
      f_x
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.max_arrays" class="md-nav__link">
    <span class="md-ellipsis">
      max_arrays
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.q_x" class="md-nav__link">
    <span class="md-ellipsis">
      q_x
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.tidal_def" class="md-nav__link">
    <span class="md-ellipsis">
      tidal_def
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.tov_equations_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      tov_equations_scaled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.TOV_class.TOV.tov_routine" class="md-nav__link">
    <span class="md-ellipsis">
      tov_routine
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-tovscaledrev" class="md-nav__link">
    <span class="md-ellipsis">
      Module: tovScaledRev
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.tovScaledRev" class="md-nav__link">
    <span class="md-ellipsis">
      tovScaledRev
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slmemulator.tovScaledRev.TOV" class="md-nav__link">
    <span class="md-ellipsis">
      TOV
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TOV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#slmemulator.tovScaledRev.TOV.baryon_from_energy" class="md-nav__link">
    <span class="md-ellipsis">
      baryon_from_energy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.tovScaledRev.TOV.energy_from_pressure" class="md-nav__link">
    <span class="md-ellipsis">
      energy_from_pressure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.tovScaledRev.TOV.pressure_from_energy" class="md-nav__link">
    <span class="md-ellipsis">
      pressure_from_energy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slmemulator.tovScaledRev.TOV.pressure_from_nb" class="md-nav__link">
    <span class="md-ellipsis">
      pressure_from_nb
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/TOV_code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TOV Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/SLM_general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SLM General
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/Parametric_SLM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parametric SLM
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../authors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LICENSE" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/asemposki/SLM/edit/main/docs/api.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="api-reference">API Reference</h1>
<p>This section provides a detailed reference for the <code>Star Log-extended eMulator</code> package.</p>
<h2 id="slmemulator-package-overview">slmemulator Package Overview</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="slmemulator.ParametricSLM" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ParametricSLM</span><span class="p">(</span><span class="n">fileList</span><span class="p">,</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">error_threshold</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">max_r</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">









                  <details class="quote">
                    <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">fileList</span><span class="p">,</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">error_threshold</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">max_r</span><span class="o">=</span><span class="kc">None</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="p">):</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="c1"># fileList is expected to be a list of Path objects from testpSLM.py</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fileList</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fileList</span><span class="p">]</span>  <span class="c1"># Ensure all are Path objects</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>  <span class="c1"># Ensure filePath is a Path object</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="o">=</span> <span class="n">tidal</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">error_threshold</span> <span class="o">=</span> <span class="n">error_threshold</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_r</span> <span class="o">=</span> <span class="n">max_r</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Number of quantities/rows in the data X</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mm1</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="kc">None</span>  <span class="c1"># Number of time points/columns in the data X (m-1 snapshots for DMD)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="c1"># Lists to store DMD components for each training file</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">D_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">b_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Store shapes (n, mm1) of training data</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="c1"># Store extracted parameters for each file, in the same order as fileList</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file_params</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">param_scaler</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Scaler for parameters, fitted in .fit()</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">scaled_params</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Scaled parameters of training data</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="slmemulator.ParametricSLM.augment_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">augment_data</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Augments the input data X by adding quadratic terms (X_i * X_j).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Original data matrix (n, m).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray (np.ndarray): Augmented data matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="k">def</span><span class="w"> </span><span class="nf">augment_data</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Augments the input data X by adding quadratic terms (X_i * X_j).</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        X (np.ndarray): Original data matrix (n, m).</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        np.ndarray (np.ndarray): Augmented data matrix.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="c1"># Add quadratic terms (combinations with replacement of rows of X)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations_with_replacement</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="c1"># Add cubic terms if needed (example commented out)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="c1"># for i, j, k in combinations_with_replacement(range(n), 3):</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="c1">#     out.append(X[i] * X[j] * X[k])</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.ParametricSLM.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Fits the Parametric SLM model by processing each file in fileList,
performing DMD, and storing the DMD components along with extracted parameters.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    Fits the Parametric SLM model by processing each file in fileList,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">    performing DMD, and storing the DMD components along with extracted parameters.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">D_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">b_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file_params</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Reset for clarity, though init should handle it</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Store shapes for consistency check in predict</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">processed_files_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="k">for</span> <span class="n">file_path_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileList</span><span class="p">:</span>  <span class="c1"># Iterate through Path objects</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="c1"># Validate file_path_obj is a Path object and exists</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_path_obj</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">file_path_obj</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping invalid or non-existent file: </span><span class="si">{</span><span class="n">file_path_obj</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="k">continue</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="c1"># Extract parameters from the filename (e.g., TOV_MS_Ls_Lv_zeta_xi.txt)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="c1"># We assume the file name format is consistent with _extract_params_from_tov_filename</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="c1"># We determine mseos based on &#39;MS&#39; or &#39;QEOS&#39; in the filename</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">is_mseos</span> <span class="o">=</span> <span class="s2">&quot;MS&quot;</span> <span class="ow">in</span> <span class="n">file_path_obj</span><span class="o">.</span><span class="n">stem</span>  <span class="c1"># Check if filename contains &#39;MS&#39;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="c1"># Call the static method using self.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_params_from_tov_filename</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="n">file_path_obj</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="n">is_mseos</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># _extract_params_from_tov_filename prints warning</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="k">continue</span>  <span class="c1"># Skip if parameters could not be extracted</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="c1"># Load data from the file</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="c1"># The file is a Path object, np.loadtxt can directly handle it</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path_obj</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>                    <span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: contains NaN or Inf values. Please check data quality.&quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                <span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>                <span class="k">continue</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="c1"># Process data (assuming data has columns like Radius, Mass, etc.)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="c1"># X should be (num_quantities, num_points)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-9</span>  <span class="c1"># Small constant to prevent log(0)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>                <span class="c1"># Assuming 4 columns: Radius, Mass, Central Pressure, Tidal Deformability</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>                <span class="c1"># Ensure data has at least 4 columns</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>                    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>                        <span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Expected at least 4 columns for tidal data, got </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>                    <span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                <span class="c1"># Assuming 3 columns: Radius, Mass, Central Pressure (or other relevant)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>                <span class="c1"># Ensure data has at least 3 columns</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>                        <span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Expected at least 3 columns for non-tidal data, got </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                    <span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>                <span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="p">)</span>  <span class="c1"># Ensure float64 for numerical stability</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="c1"># Store shape for consistency checks in predict</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="p">):</span>  <span class="c1"># Only set for the very first successfully processed file</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mm1</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">augmented_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment_data</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mm1</span><span class="p">))</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="k">elif</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="ow">or</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mm1</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                    <span class="sa">f</span><span class="s2">&quot;Warning: </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> has inconsistent shape </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">. Expected (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mm1</span><span class="si">}</span><span class="s2">). Skipping.&quot;</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>                <span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                <span class="k">continue</span>  <span class="c1"># Skip files with inconsistent shapes for DMD</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Assuming uniform time step of 1.0 between data points</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SLM_auto_r</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>  <span class="c1"># Perform SLM and get optimal rank</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="c1"># Check if SLM_auto_r returned a valid result</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">):</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                    <span class="sa">f</span><span class="s2">&quot;Failed to fit SLM model for </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">. Skipping.&quot;</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                <span class="k">continue</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="c1"># Store DMD components and parameters for successful fits</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Phi&quot;</span><span class="p">])</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">])</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">D_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">])</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">b_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">])</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">file_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>                <span class="n">params</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="p">)</span>  <span class="c1"># Store parameters for the processed file</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="p">)</span>  <span class="c1"># Store shape for this specific training data</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="n">processed_files_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="c1"># print(f&quot;Successfully processed {file_path_obj.name}. Max error: {result[&#39;err&#39;]:.4e}&quot;)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing file </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. Skipping.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="k">continue</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">if</span> <span class="n">processed_files_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="s2">&quot;No valid training files processed! Please check your input data and `error_threshold`.&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="c1"># Fit StandardScaler on the collected parameters</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_params</span><span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">param_scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">scaled_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.ParametricSLM.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_interp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distance_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Predicts the dynamics (Xdmd) for a given set of parameters by finding nearest neighbors
in the parameter space and averaging their DMD components or using the closest one.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>param_values</code>
            </td>
            <td>
                  <code><span title="list">list</span> or <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list or array of parameter values to predict for
                                         (e.g., [Ls, Lv, zeta, xi] for MSEOS). This argument is mandatory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of nearest neighbors to use for prediction.
     Defaults to 1 (pure nearest neighbor).</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_interp</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, interpolate the final Xdmd outputs by averaging curves.
                  If False (default) and k&gt;1, averages the DMD components (Phi, omega, D, b).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distance_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the distance to the closest neighbor
                                  exceeds this threshold, a warning is printed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(Phi_avg/Phi_nn, omega_avg/omega_nn, D_avg/D_nn, b_avg/b_nn, Xdmd_predicted, t)
   - Reconstructed data (Xdmd_predicted) and related averaged DMD components.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Raises:
    ValueError: If the model has not been fitted or no training data is available.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_values</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_interp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distance_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">    Predicts the dynamics (Xdmd) for a given set of parameters by finding nearest neighbors</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">    in the parameter space and averaging their DMD components or using the closest one.</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        param_values (list or np.ndarray): A list or array of parameter values to predict for</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">                                                     (e.g., [Ls, Lv, zeta, xi] for MSEOS). This argument is mandatory.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        k (int): Number of nearest neighbors to use for prediction.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">                 Defaults to 1 (pure nearest neighbor).</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        output_interp (bool): If True, interpolate the final Xdmd outputs by averaging curves.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">                              If False (default) and k&gt;1, averages the DMD components (Phi, omega, D, b).</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        distance_threshold (float, optional): If the distance to the closest neighbor</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">                                              exceeds this threshold, a warning is printed.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        tuple: (Phi_avg/Phi_nn, omega_avg/omega_nn, D_avg/D_nn, b_avg/b_nn, Xdmd_predicted, t)</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">               - Reconstructed data (Xdmd_predicted) and related averaged DMD components.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        ValueError: If the model has not been fitted or no training data is available.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model not fitted. Call .fit() first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_params</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No training data parameters available from fit().&quot;</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="c1"># If param_values are provided (the main use case for prediction)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="c1"># Scale the input parameters using the fitted scaler</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">scaled_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">theta</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="sa">f</span><span class="s2">&quot;Parameter scaling failed for </span><span class="si">{</span><span class="n">theta</span><span class="si">}</span><span class="s2">. Ensure input matches training dimensions. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="c1"># Calculate Euclidean distances to all scaled training parameters</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_params</span> <span class="o">-</span> <span class="n">scaled_theta</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="c1"># Get indices of k smallest distances</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="c1"># Ensure k does not exceed the number of available training samples</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">k_actual</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_params</span><span class="p">))</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">if</span> <span class="n">k_actual</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No training data available to make a prediction.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="n">idxs</span> <span class="o">=</span> <span class="n">sorted_indices</span><span class="p">[:</span><span class="n">k_actual</span><span class="p">]</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="c1"># Check if the closest neighbor is too far (optional warning/handling)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="k">if</span> <span class="n">distance_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dists</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">distance_threshold</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="sa">f</span><span class="s2">&quot;Warning: Closest neighbor distance (</span><span class="si">{</span><span class="n">dists</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">) exceeds threshold (</span><span class="si">{</span><span class="n">distance_threshold</span><span class="si">}</span><span class="s2">). &quot;</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="sa">f</span><span class="s2">&quot;Prediction might be unreliable for parameters </span><span class="si">{</span><span class="n">param_values</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="c1"># Use the shape of the training data corresponding to the first nearest neighbor</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="c1"># as the reference shape for reconstruction (assuming consistency)</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span><span class="p">:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>            <span class="s2">&quot;Training data shapes not recorded during fit(). Cannot predict.&quot;</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="c1"># Use the original (non-augmented) shape of training data for reconstruction</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="n">ref_n_original</span><span class="p">,</span> <span class="n">ref_mm1_original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span><span class="p">[</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="p">]</span>  <span class="c1"># Use shape from first nearest neighbor</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Assuming original dt=1.0</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">if</span> <span class="n">output_interp</span> <span class="ow">and</span> <span class="n">k_actual</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="c1"># Option 1: Interpolate outputs by averaging reconstructed curves</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="n">curves</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="n">Phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>            <span class="n">t_reconstruction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ref_mm1_original</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                <span class="n">omega</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">t_reconstruction</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="n">Xdmd_full_aug</span> <span class="o">=</span> <span class="n">Phi</span> <span class="o">@</span> <span class="n">time_dynamics</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="n">Xdmd</span> <span class="o">=</span> <span class="n">Xdmd_full_aug</span><span class="p">[</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                <span class="p">:</span><span class="n">ref_n_original</span><span class="p">,</span> <span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="p">]</span>  <span class="c1"># Trim back to original dimensions</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="n">curves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">Xdmd_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">curves</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Average the reconstructed curves</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="c1"># For consistency, return averaged DMD components even if output is interpolated</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">Phi_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="n">omega_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">D_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">D_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="n">b_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">Phi_avg</span><span class="p">,</span> <span class="n">omega_avg</span><span class="p">,</span> <span class="n">D_avg</span><span class="p">,</span> <span class="n">b_avg</span><span class="p">,</span> <span class="n">Xdmd_predicted</span><span class="p">,</span> <span class="n">t_reconstruction</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="c1"># Option 2: Average DMD components (Phi, omega, D, b) from k nearest neighbors</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="c1"># (or just use the single nearest neighbor if k=1 or output_interp is False)</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">Phi_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">omega_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="n">D_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">D_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">b_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">t_reconstruction</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ref_mm1_original</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="p">)</span>  <span class="c1"># Time points for prediction</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">b_avg</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="n">omega_avg</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">t_reconstruction</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="p">)</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="n">Xdmd_full_aug</span> <span class="o">=</span> <span class="n">Phi_avg</span> <span class="o">@</span> <span class="n">time_dynamics</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">Xdmd_predicted</span> <span class="o">=</span> <span class="n">Xdmd_full_aug</span><span class="p">[</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="p">:</span><span class="n">ref_n_original</span><span class="p">,</span> <span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="p">]</span>  <span class="c1"># Trim back to original dimensions</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">Phi_avg</span><span class="p">,</span> <span class="n">omega_avg</span><span class="p">,</span> <span class="n">D_avg</span><span class="p">,</span> <span class="n">b_avg</span><span class="p">,</span> <span class="n">Xdmd_predicted</span><span class="p">,</span> <span class="n">t_reconstruction</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="slmemulator.augment_data_multiple_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">augment_data_multiple_columns</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Augment the data matrix X with nonlinear terms for multiple variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data matrix where each row is a variable, and each column 
is a snapshot in time.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>augmented_X</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The augmented data matrix with nonlinear terms.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/SLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">augment_data_multiple_columns</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Augment the data matrix X with nonlinear terms for multiple variables.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        X (np.ndarray): The data matrix where each row is a variable, and each column </span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            is a snapshot in time.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        augmented_X (np.ndarray): The augmented data matrix with nonlinear terms.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">n_variables</span><span class="p">,</span> <span class="n">n_snapshots</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="c1"># Calculate the number of augmented terms</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">num_augmented_terms</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">combinations_with_replacement</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_variables</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="c1"># Pre-allocate the augmented matrix</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">augmented_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="p">(</span><span class="n">n_variables</span> <span class="o">+</span> <span class="n">num_augmented_terms</span><span class="p">,</span> <span class="n">n_snapshots</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">augmented_X</span><span class="p">[:</span><span class="n">n_variables</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">X</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="c1"># Add quadratic terms and cross-products</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">row_idx</span> <span class="o">=</span> <span class="n">n_variables</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations_with_replacement</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_variables</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">augmented_X</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">row_idx</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="k">return</span> <span class="n">augmented_X</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.clean_directory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clean_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Cleans up specified files and directories within a given directory.</p>
        <p>directory (str): The path to the directory to clean. Defaults to the
                 current working directory if None.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/cleanData.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="k">def</span><span class="w"> </span><span class="nf">clean_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Cleans up specified files and directories within a given directory.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    directory (str): The path to the directory to clean. Defaults to the</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">                     current working directory if None.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="c1"># Ensure the target directory exists and is a directory</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">target_dir_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_dir_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Directory &#39;</span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">&#39; not found or is not a directory.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="k">return</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cleaning directory: </span><span class="si">{</span><span class="n">target_dir_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="c1"># List of additional folders created by the code that you want to remove recursively.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="c1"># These are now relative to the &#39;directory&#39; argument.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">additional_folders_to_clean_names</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">DEFAULT_EOS_FILES_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">DEFAULT_RESULTS_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">DEFAULT_TOV_DATA_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">DEFAULT_TEST_DATA_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">DEFAULT_TRAIN_DATA_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">DEFAULT_PLOTS_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="p">]</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="c1"># Convert these names to full paths within the target directory</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">additional_folders_to_clean_paths</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">target_dir_path</span> <span class="o">/</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">additional_folders_to_clean_names</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="p">]</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">target_dir_path</span><span class="p">,</span> <span class="n">topdown</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="p">):</span>  <span class="c1"># Traverse from bottom to top</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="c1"># Clean files matching patterns in cleanup_targets</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="k">for</span> <span class="n">target_ext</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cleanup_targets</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="p">]:</span>  <span class="c1"># Only check extensions</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">target_ext</span><span class="p">):</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="c1"># Clean directories matching patterns in cleanup_targets (by name)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="c1"># or directories matching full paths in additional_folders_to_clean_paths</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">for</span> <span class="n">dir_name</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="n">dir_full_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">/</span> <span class="n">dir_name</span>  <span class="c1"># Use Path for comparison</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="n">dir_name</span> <span class="ow">in</span> <span class="n">cleanup_targets</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                <span class="ow">or</span> <span class="n">dir_full_path</span> <span class="ow">in</span> <span class="n">additional_folders_to_clean_paths</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="p">):</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing directory: </span><span class="si">{</span><span class="n">dir_full_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">dir_full_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.gaussian_rbf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gaussian_rbf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Gaussian Radial Basis Function.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/recombination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">gaussian_rbf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">):</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gaussian Radial Basis Function.&quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">epsilon</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.is_on_boundary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_on_boundary</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">param_min</span><span class="p">,</span> <span class="n">param_max</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Checks if a parameter set is on the boundary of the parameter space.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_on_boundary</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">param_min</span><span class="p">,</span> <span class="n">param_max</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if a parameter set is on the boundary of the parameter space.&quot;&quot;&quot;</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">)):</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="nb">abs</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">param_min</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tolerance</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">param_max</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tolerance</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="p">):</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.plot_S" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_S</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">plots_output_base_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plots the singular values from DMD.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>S</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of singular values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plots_output_base_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> or <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where plot files should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/plotData.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot_S</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">plots_output_base_path</span><span class="p">):</span>  <span class="c1"># Added plots_output_base_path</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    Plots the singular values from DMD.</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        S (np.ndarray): Array of singular values.</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        plots_output_base_path (Path or str): The base directory where plot files should be saved.</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="n">plots_output_base_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">plots_output_base_path</span><span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="n">plots_output_base_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Ensure directory exists</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="c1"># Plot the S values:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span> <span class="o">/</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Index&quot;</span><span class="p">)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;S values&quot;</span><span class="p">)</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plots_output_base_path</span> <span class="o">/</span> <span class="s2">&quot;Svalues.pdf&quot;</span><span class="p">)</span>  <span class="c1"># Updated save path</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Use close instead of cla for cleaner resource management</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.plot_eigs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_eigs</span><span class="p">(</span><span class="n">eigs</span><span class="p">,</span> <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_unit_circle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">narrow_view</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot the eigenvalues.
:param bool show_axes: if True, the axes will be shown in the plot.
:param bool show_unit_circle: if True, a unit circle centered at the origin will be shown.
:param tuple(int,int) figsize: tuple defining the figure size in inches. Default is (8, 8).
:param str title: title of the plot.
:param narrow_view bool: if True, the plot will show only the smallest rectangular area containing
    all the eigenvalues, with a padding of 0.05. Not compatible with <code>show_axes=True</code>.
:param dpi int: If not None, passed to <code>plt.figure</code>.
:param Path or str output_path: if specified, the plot is saved at this path.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/plotData.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot_eigs</span><span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">eigs</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">show_unit_circle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">narrow_view</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">output_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Renamed from &#39;filename&#39; for clarity</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="p">):</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    Plot the eigenvalues.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    :param bool show_axes: if True, the axes will be shown in the plot.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    :param bool show_unit_circle: if True, a unit circle centered at the origin will be shown.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    :param tuple(int,int) figsize: tuple defining the figure size in inches. Default is (8, 8).</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    :param str title: title of the plot.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    :param narrow_view bool: if True, the plot will show only the smallest rectangular area containing</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        all the eigenvalues, with a padding of 0.05. Not compatible with `show_axes=True`.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    :param dpi int: If not None, passed to ``plt.figure``.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    :param Path or str output_path: if specified, the plot is saved at this path.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="p">(</span><span class="n">points</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">eigs</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">eigs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eigenvalues&quot;</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="p">)</span>  <span class="c1"># Comma unpacks to Line2D object</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">if</span> <span class="n">narrow_view</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">supx</span><span class="p">,</span> <span class="n">infx</span><span class="p">,</span> <span class="n">supy</span><span class="p">,</span> <span class="n">infy</span> <span class="o">=</span> <span class="n">_plot_limits</span><span class="p">(</span><span class="n">eigs</span><span class="p">,</span> <span class="n">narrow_view</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">infx</span><span class="p">,</span> <span class="n">supx</span><span class="p">))</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">infy</span><span class="p">,</span> <span class="n">supy</span><span class="p">))</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">if</span> <span class="n">show_axes</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="n">endx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">supx</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>                <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">endx</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">infx</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span> <span class="k">if</span> <span class="n">endx</span> <span class="o">==</span> <span class="mf">1.0</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">),</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">endy</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">supy</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">endy</span><span class="p">),</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">infy</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)),</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span> <span class="k">if</span> <span class="n">endy</span> <span class="o">==</span> <span class="mf">1.0</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">),</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">limit</span> <span class="o">=</span> <span class="n">_plot_limits</span><span class="p">(</span><span class="n">eigs</span><span class="p">,</span> <span class="n">narrow_view</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="k">if</span> <span class="n">show_axes</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)),</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Real part&quot;</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Imaginary part&quot;</span><span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="c1"># Unit circle</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">if</span> <span class="n">show_unit_circle</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">unit_circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Unit circle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">unit_circle</span><span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Legend handling</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">if</span> <span class="n">show_unit_circle</span><span class="p">:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">points</span><span class="p">,</span> <span class="n">unit_circle</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Eigenvalues&quot;</span><span class="p">,</span> <span class="s2">&quot;Unit circle&quot;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">points</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Eigenvalues&quot;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="k">if</span> <span class="n">output_path</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">output_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Ensure directory exists</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Close the figure to free memory</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.plot_parametric" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_parametric</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">,</span> <span class="n">X_exact</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tidal</span><span class="p">,</span> <span class="n">plots_output_base_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plots the reconstructed DMD data against the exact data for parametric runs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Xdmd</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reconstructed data (variables x snapshots).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X_exact</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exact data (variables x snapshots).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base name for the plot file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tidal</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean, indicates if tidal data is being plotted (affects labels).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plots_output_base_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> or <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where plot files should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/plotData.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot_parametric</span><span class="p">(</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="n">Xdmd</span><span class="p">,</span> <span class="n">X_exact</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tidal</span><span class="p">,</span> <span class="n">plots_output_base_path</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="p">):</span>  <span class="c1"># Added plots_output_base_path</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    Plots the reconstructed DMD data against the exact data for parametric runs.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        Xdmd (np.ndarray): Reconstructed data (variables x snapshots).</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        X_exact (np.ndarray): Exact data (variables x snapshots).</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        name (str): Base name for the plot file.</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        tidal (bool): Boolean, indicates if tidal data is being plotted (affects labels).</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">        plots_output_base_path (Path or str): The base directory where plot files should be saved.</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="n">plots_output_base_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">plots_output_base_path</span><span class="p">)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="n">plots_output_base_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="n">num_snapshots</span> <span class="o">=</span> <span class="n">Xdmd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="n">time_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_snapshots</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span>  <span class="c1"># Assuming dt = 1.0</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">Xdmd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="k">if</span> <span class="n">Xdmd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">axs</span><span class="p">]</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="k">if</span> <span class="n">tidal</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="n">var_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;R_b&quot;</span><span class="p">,</span> <span class="s2">&quot;M_b&quot;</span><span class="p">,</span> <span class="s2">&quot;k2_tidal&quot;</span><span class="p">]</span>  <span class="c1"># Customize for your specific variables</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">var_labels</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>            <span class="sa">f</span><span class="s2">&quot;Variable </span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Xdmd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Generic labels</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="p">]</span>  <span class="c1"># Default for non-tidal, adjust if needed</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Xdmd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_points</span><span class="p">,</span> <span class="n">X_exact</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="c1"># Assuming Xdmd is log-scaled and needs np.exp</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>            <span class="n">time_points</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">),</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DMD Prediction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">else</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="p">)</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">var_labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time Step&quot;</span><span class="p">)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DMD Prediction vs Exact Data for </span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Data_&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="c1"># Save the plot to the designated directory</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="n">plots_output_base_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;SLMpredict_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.png&quot;</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.plot_parametric_old" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_parametric_old</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plots_output_base_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Makes plots for parametric DMD (old version).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Xdmd</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reconstructed data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Original data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base name for the plot file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tidal</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, indicates tidal data. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xlim</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis limits for plots. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylim</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-axis limits for plots. Defaults to None. Each inner list is [ymin, ymax].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plots_output_base_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> or <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where plot files should be saved.
                                            Defaults to None (will use current directory if not provided).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/plotData.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot_parametric_old</span><span class="p">(</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="n">Xdmd</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plots_output_base_path</span><span class="o">=</span><span class="kc">None</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="p">):</span>  <span class="c1"># Added plots_output_base_path</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    Makes plots for parametric DMD (old version).</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        Xdmd (np.ndarray): Reconstructed data.</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        X (np.ndarray): Original data.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        name (str): Base name for the plot file.</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        tidal (bool, optional): If True, indicates tidal data. Defaults to False.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        xlim (list, optional): X-axis limits for plots. Defaults to None.</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">        ylim (list[list], optional): Y-axis limits for plots. Defaults to None. Each inner list is [ymin, ymax].</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        plots_output_base_path (Path or str, optional): The base directory where plot files should be saved.</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">                                                        Defaults to None (will use current directory if not provided).</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="n">plots_output_base_path</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="n">Path</span><span class="p">(</span><span class="n">plots_output_base_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">plots_output_base_path</span> <span class="k">else</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="n">plots_output_base_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="n">names</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Names&quot;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape&quot;</span><span class="p">,</span> <span class="n">Xdmd</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="k">if</span> <span class="n">tidal</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">),</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">),</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DMD&quot;</span><span class="p">,</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;-data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ylim</span><span class="p">):</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">xlim</span><span class="p">):</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">names</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))])</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Radius (km)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="sa">r</span><span class="s2">&quot;Mass $(M_{\odot})$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="p">)</span>  <span class="c1"># This might need to be dynamic</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="c1"># Updated save paths</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plots_output_base_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;MRpredict_</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plots_output_base_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;Tidalpredict_</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Use close instead of cla for cleaner resource management</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.plot_slm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_slm</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Xdmd</span><span class="p">,</span> <span class="n">fileNames_for_labels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">,</span> <span class="n">plots_output_base_path</span><span class="p">,</span> <span class="n">base_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Makes plots for the dmds in a time-series manner.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time vector or index for the x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Original data, typically (num_quantities, num_time_points).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Xdmd</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reconstructed DMD data, (num_quantities, num_time_points).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fileNames_for_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] or <span title="list">list</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings or Path objects
                                             used for generating plot titles and unique filenames.
                                             Its length should correspond to len(Xdmd).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylabels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of y-axis labels for each plot. Its length should match len(Xdmd).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plots_output_base_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> or <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where plot files should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A base name to use for generated plot filenames,
                       e.g., derived from the original data file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/plotData.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot_slm</span><span class="p">(</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Xdmd</span><span class="p">,</span> <span class="n">fileNames_for_labels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">,</span> <span class="n">plots_output_base_path</span><span class="p">,</span> <span class="n">base_name</span><span class="o">=</span><span class="kc">None</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="p">):</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    Makes plots for the dmds in a time-series manner.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        t (np.ndarray): Time vector or index for the x-axis.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        X (np.ndarray): Original data, typically (num_quantities, num_time_points).</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        Xdmd (np.ndarray): Reconstructed DMD data, (num_quantities, num_time_points).</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        fileNames_for_labels (list[str] or list[Path]): A list of strings or Path objects</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">                                                         used for generating plot titles and unique filenames.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">                                                         Its length should correspond to len(Xdmd).</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        ylabels (list[str]): A list of y-axis labels for each plot. Its length should match len(Xdmd).</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        plots_output_base_path (Path or str): The base directory where plot files should be saved.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        base_name (str, optional): A base name to use for generated plot filenames,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">                                   e.g., derived from the original data file.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">plots_output_base_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">plots_output_base_path</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">plots_output_base_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">linT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="p">)</span>  <span class="c1"># Using linT as an index if t is not provided for plot_slm</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="c1"># Use base_name for title parts if available, otherwise fallback to first label source</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">namesList</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="k">if</span> <span class="n">base_name</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">namesList</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">base_name</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="k">elif</span> <span class="n">fileNames_for_labels</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">namesList</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">fileNames_for_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">)):</span>  <span class="c1"># Loop for each quantity</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DMD&quot;</span><span class="p">)</span>  <span class="c1"># Assuming Xdmd is log-scaled</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="n">linT</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="p">)</span>  <span class="c1"># Assuming X is log-scaled, adjust if not</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>  <span class="c1"># Or r&quot;Time [units]&quot; if t is actual time</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">titleName</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">namesList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Attempt to parse parameters from filename for title</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="c1"># This part needs to be adapted based on specific filename conventions</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="n">title_parts</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="sa">rf</span><span class="s2">&quot;$p_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">$ = </span><span class="si">{</span><span class="n">namesList</span><span class="p">[</span><span class="mi">2</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">namesList</span><span class="p">[</span><span class="mi">2</span><span class="p">:]))</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="p">]</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="n">titleName</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">title_parts</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titleName</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variable: </span><span class="si">{</span><span class="n">ylabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="c1"># Create a unique filename for the plot</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">safe_ylabel</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="n">ylabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">plot_file_name</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="sa">f</span><span class="s2">&quot;DMD_</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="n">base_name</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">base_name</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;plot&#39;</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">safe_ylabel</span><span class="si">}</span><span class="s2">.png&quot;</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plots_output_base_path</span> <span class="o">/</span> <span class="n">plot_file_name</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.plot_slm_rad" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_slm_rad</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Xdmd</span><span class="p">,</span> <span class="n">fileNames_for_labels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">,</span> <span class="n">plots_output_base_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Makes plots for the SLM DMD results compared to original data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The "real" or original data, typically (num_quantities, num_points).
            Assumed X[0] is Radius, X[1:] are other quantities (e.g., Pressure, Energy Density).
            Values should be log-scaled if np.exp is used for plotting.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Xdmd</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SLM-derived (reconstructed) data, (num_quantities, num_points).
               Assumed Xdmd[0] is Radius, Xdmd[1:] are other quantities.
               Values should be log-scaled if np.exp is used for plotting.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fileNames_for_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] or <span title="list">list</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list containing a single string or Path object.
                                             This object is used to derive plot titles and base filenames,
                                             as all plots from a single Xdmd set share the same EOS parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylabels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of y-axis labels for each plot. Its length should match len(Xdmd) - 1.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plots_output_base_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> or <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where plot files should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/plotData.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot_slm_rad</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Xdmd</span><span class="p">,</span> <span class="n">fileNames_for_labels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">,</span> <span class="n">plots_output_base_path</span><span class="p">):</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    Makes plots for the SLM DMD results compared to original data.</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        X (np.ndarray): The &quot;real&quot; or original data, typically (num_quantities, num_points).</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">                        Assumed X[0] is Radius, X[1:] are other quantities (e.g., Pressure, Energy Density).</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">                        Values should be log-scaled if np.exp is used for plotting.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        Xdmd (np.ndarray): The SLM-derived (reconstructed) data, (num_quantities, num_points).</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">                           Assumed Xdmd[0] is Radius, Xdmd[1:] are other quantities.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">                           Values should be log-scaled if np.exp is used for plotting.</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        fileNames_for_labels (list[str] or list[Path]): A list containing a single string or Path object.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">                                                         This object is used to derive plot titles and base filenames,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">                                                         as all plots from a single Xdmd set share the same EOS parameters.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        ylabels (list[str]): A list of y-axis labels for each plot. Its length should match len(Xdmd) - 1.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        plots_output_base_path (Path or str): The base directory where plot files should be saved.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="c1"># Ensure plots_output_base_path is a Path object and exists</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">plots_output_base_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">plots_output_base_path</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">plots_output_base_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="c1"># The loop iterates (len(Xdmd) - 1) times, meaning it makes this many plots.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="c1"># Each plot corresponds to a pair (X[0], X[i+1]) and (Xdmd[0], Xdmd[i+1])</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="c1"># fileNames_for_labels[i] and ylabels[i] should align with each plot.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="c1"># Use the first (and presumably only) element of fileNames_for_labels</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="c1"># as the source for parameter information for the plot title and filename.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="c1"># This assumes that all variables in a single Xdmd correspond to one EOS run.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">fileNames_for_labels</span><span class="p">:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fileNames_for_labels cannot be empty for plot_slm_rad.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">base_label_source</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">fileNames_for_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="p">)</span>  <span class="c1"># Changed from fileNames_for_labels[i]</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># Loop for each quantity beyond Radius</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="c1"># Ensure values are positive before taking np.exp if they are log-scaled</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="c1"># Adding a small epsilon to avoid log(0) issues if Xdmd/X can contain 0 or negative</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;SLM&quot;</span><span class="p">)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Radius [km]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="n">labelsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="p">)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="c1"># Generate title and save filename based on base_label_source</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">namesList</span> <span class="o">=</span> <span class="n">base_label_source</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>  <span class="c1"># Use base_label_source</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">titleName</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="c1"># Customize title based on your EOS naming conventions</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">if</span> <span class="n">namesList</span> <span class="ow">and</span> <span class="n">namesList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;mseos&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">namesList</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="n">titleName</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                <span class="sa">f</span><span class="s2">&quot;MSEOS: Ls=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">namesList</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Lv=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">namesList</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>                <span class="sa">f</span><span class="s2">&quot;zeta=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">namesList</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">, xi=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">namesList</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">elif</span> <span class="n">namesList</span> <span class="ow">and</span> <span class="n">namesList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;qeos&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">namesList</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="n">titleName</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Quarkyonia: Lambda=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">namesList</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Kappa=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">namesList</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># For non-parametric or other unknown names</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">titleName</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;EOS: </span><span class="si">{</span><span class="n">base_label_source</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># Use base_label_source</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titleName</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="c1"># Create a unique filename for the plot, saved to plots_output_base_path</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="c1"># Combine base EOS name, the y-axis quantity, and make it filesystem-safe</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="n">safe_ylabel</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="n">ylabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="p">)</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="n">plot_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_label_source</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_plot_</span><span class="si">{</span><span class="n">safe_ylabel</span><span class="si">}</span><span class="s2">.png&quot;</span>  <span class="c1"># Use base_label_source.stem</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="c1"># Save the plot to the correct directory</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plots_output_base_path</span> <span class="o">/</span> <span class="n">plot_file_name</span><span class="p">)</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Close the figure to free memory</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.recombination_thinning" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">recombination_thinning</span><span class="p">(</span><span class="n">A_matrix</span><span class="p">,</span> <span class="n">y_vector</span><span class="p">,</span> <span class="n">initial_solution_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-09</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Conceptual implementation of the recombination thinning process based on the paper.
This function aims to find a sparse solution x' to the linear system Ax = y.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A_matrix</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix A in the linear system Ax = y.
                 In the context of GRIM, this matrix relates features and
                 linear functionals.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_vector</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vector y in the linear system Ax = y.
                 In the context of GRIM, this relates to the target function
                 evaluated by linear functionals.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_solution_x</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An initial solution vector x. If None,
                                      a least squares solution is computed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tolerance</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tolerance for numerical stability, especially for SVD and
               checking non-zero components.</p>
              </div>
            </td>
            <td>
                  <code>1e-09</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.array: A sparser solution vector x' for the system Ax = y.
      Returns None if the system is inconsistent or other issues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/recombination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">recombination_thinning</span><span class="p">(</span><span class="n">A_matrix</span><span class="p">,</span> <span class="n">y_vector</span><span class="p">,</span> <span class="n">initial_solution_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Conceptual implementation of the recombination thinning process based on the paper.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    This function aims to find a sparse solution x&#39; to the linear system Ax = y.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        A_matrix (np.array): The matrix A in the linear system Ax = y.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">                             In the context of GRIM, this matrix relates features and</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">                             linear functionals.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        y_vector (np.array): The vector y in the linear system Ax = y.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">                             In the context of GRIM, this relates to the target function</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">                             evaluated by linear functionals.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        initial_solution_x (np.array, optional): An initial solution vector x. If None,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">                                                  a least squares solution is computed.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        tolerance (float): Tolerance for numerical stability, especially for SVD and</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">                           checking non-zero components.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        np.array: A sparser solution vector x&#39; for the system Ax = y.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">                  Returns None if the system is inconsistent or other issues.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">if</span> <span class="n">A_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y_vector</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dimensions of A_matrix and y_vector are not compatible.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="c1"># 2. Find an initial solution x if not provided</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">if</span> <span class="n">initial_solution_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="n">initial_solution_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A_matrix</span><span class="p">,</span> <span class="n">y_vector</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span><span class="p">:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>                <span class="s2">&quot;Warning: Least squares solution failed for initial_solution_x. Returning None.&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="c1"># The `recombination_thinning` as provided aims to return an initial least squares solution.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="c1"># For more advanced thinning/sparsity, additional iterative logic or L1 regularization</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="c1"># would typically be integrated here. As per your provided `bgrim.py` and prior discussions,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="c1"># we are using this function&#39;s current behavior.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">return</span> <span class="n">initial_solution_x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.solve_tov" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_tov</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parametric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mseos</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Solves the TOV equation and returns radius, mass and central pressure</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fileName</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filename containing the EOS in the format nb (fm^-3),
E (MeV), P (MeV/fm^3)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dataArray</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data array containing radii, central pressure
and mass.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/SLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="k">def</span><span class="w"> </span><span class="nf">solve_tov</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parametric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mseos</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Solves the TOV equation and returns radius, mass and central pressure</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        fileName (str): Filename containing the EOS in the format nb (fm^-3),</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            E (MeV), P (MeV/fm^3)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        dataArray (array): Data array containing radii, central pressure</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            and mass.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Get current paths from the config module</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">paths</span> <span class="o">=</span> <span class="n">get_paths</span><span class="p">()</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="n">eos_file_path</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">tov_path_target</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">if</span> <span class="n">parametric</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="c1"># Access EOS_Data as package resource</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="n">slm_package_base</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="n">_SLM_PACKAGE_NAME</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="c1"># Get a Path-like object to the EOS_Data file within the installed package</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">eos_file_path</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="n">_INTERNAL_EOS_DATA_PATH</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="n">fileName</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="n">eos_data_resource_dir</span> <span class="o">=</span> <span class="n">slm_package_base</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;EOS_Data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="n">eos_file_path</span> <span class="o">=</span> <span class="n">eos_data_resource_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="c1"># When passing to TOV, ensure it&#39;s a string path if the solver expects it</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="n">file</span> <span class="o">=</span> <span class="n">TOV</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">eos_file_path</span><span class="p">),</span> <span class="n">tidal</span><span class="o">=</span><span class="n">tidal</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">tov_path_target</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;tov_data_dir&quot;</span><span class="p">]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="sa">f</span><span class="s2">&quot;Internal EOS file &#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s2">&#39; not found in package data.&quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="c1"># Access EOS_files from external configured path</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">if</span> <span class="n">mseos</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="n">eos_file_path</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;mseos_path&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">fileName</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">tov_path_target</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;mseos_tov_path&quot;</span><span class="p">]</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="n">eos_file_path</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;qeos_path&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">fileName</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="n">tov_path_target</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;qeos_tov_path&quot;</span><span class="p">]</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Path:&quot;</span><span class="p">,</span> <span class="n">eos_file_path</span><span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">file</span> <span class="o">=</span> <span class="n">TOV</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">eos_file_path</span><span class="p">),</span> <span class="n">tidal</span><span class="o">=</span><span class="n">tidal</span><span class="p">)</span>  <span class="c1"># Pass as string path</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="c1"># Now tov_path_target is guaranteed to be assigned</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tov_path_target</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">tov_path_target</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">file</span><span class="o">.</span><span class="n">tov_routine</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R of 1.4 solar mass star: &quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">canonical_NS_radius</span><span class="p">())</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">dataArray</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">file</span><span class="o">.</span><span class="n">total_radius</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">file</span><span class="o">.</span><span class="n">total_pres_central</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">file</span><span class="o">.</span><span class="n">total_mass</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="p">]</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="k">if</span> <span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">dataArray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="c1"># dataArray.append(file.tidal_deformability.flatten()[::-1])</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">dataArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dataArray</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="c1"># Construct the output filename more robustly</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">name_parts</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Name parts:&quot;</span><span class="p">,</span> <span class="n">name_parts</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">output_file_name</span> <span class="o">=</span> <span class="s2">&quot;MR_&quot;</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">output_file_name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;MR&quot;</span><span class="p">,</span> <span class="n">name_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;TOV&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="c1"># Save directly to the target path without changing directory</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="n">output_full_path</span> <span class="o">=</span> <span class="n">tov_path_target</span> <span class="o">/</span> <span class="n">output_file_name</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">output_full_path</span><span class="p">,</span> <span class="n">dataArray</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%1.8e</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="k">return</span> <span class="n">dataArray</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
members: true
show_if_no_docstring: true</p>
<h2 id="module-slm">Module: SLM</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator.SLM"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="slmemulator.SLM.SLM" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">SLM</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">error_threshold</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">max_r</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Dynamic Mode decomposition for the augmented Data.
Automatically determines the number of modes (r) based on an error threshold.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data matrix where each row is a variable, and each column is a snapshot 
in time. Expected to be log-transformed where appropriate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="numpy.float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time difference of linear DMDs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>error_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(Optional) The maximum allowed absolute difference between the 
original data and the DMD reconstruction. Defaults to 1e-4.</p>
              </div>
            </td>
            <td>
                  <code>0.0001</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_r</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(Optional) The maximum number of modes to consider. If None, it will go up to
the maximum possible rank (min(X.shape)).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/SLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="k">def</span><span class="w"> </span><span class="nf">SLM</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">error_threshold</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">max_r</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Dynamic Mode decomposition for the augmented Data.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    Automatically determines the number of modes (r) based on an error threshold.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        X (np.ndarray): The data matrix where each row is a variable, and each column is a snapshot </span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">            in time. Expected to be log-transformed where appropriate.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        dt (np.float): The time difference of linear DMDs.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        error_threshold (float): (Optional) The maximum allowed absolute difference between the </span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            original data and the DMD reconstruction. Defaults to 1e-4.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        max_r (int): (Optional) The maximum number of modes to consider. If None, it will go up to</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            the maximum possible rank (min(X.shape)).</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Original number of variables before augmentation</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">X_augmented</span> <span class="o">=</span> <span class="n">augment_data_multiple_columns</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">X1</span> <span class="o">=</span> <span class="n">X_augmented</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># All columns except the last</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">X2</span> <span class="o">=</span> <span class="n">X_augmented</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>  <span class="c1"># All columns except the first</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="c1"># Compute SVD of X1 once</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">U_full</span><span class="p">,</span> <span class="n">S_full</span><span class="p">,</span> <span class="n">Vt_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="c1"># Determine the maximum possible rank</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">max_possible_r</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">if</span> <span class="n">max_r</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">max_r_to_check</span> <span class="o">=</span> <span class="n">max_possible_r</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">max_r_to_check</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_r</span><span class="p">,</span> <span class="n">max_possible_r</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="c1"># Initialize r and best_error</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">r_optimal</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">min_error</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">best_Xdmd</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">best_Phi</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">best_omega</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">best_lambda_vals</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">best_b</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="c1"># Iterate through possible ranks to find the optimal &#39;r&#39;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">for</span> <span class="n">r_current</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_r_to_check</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">U_r</span> <span class="o">=</span> <span class="n">U_full</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r_current</span><span class="p">]</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="n">S_r_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">S_full</span><span class="p">[:</span><span class="n">r_current</span><span class="p">])</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">V_r</span> <span class="o">=</span> <span class="n">Vt_full</span><span class="p">[:</span><span class="n">r_current</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="c1"># Compute Atilde</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">Atilde</span> <span class="o">=</span> <span class="n">U_r</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">V_r</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">S_r_inv</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="c1"># Compute eigenvectors and eigenvalues</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">D</span><span class="p">,</span> <span class="n">W_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Atilde</span><span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">Phi_current</span> <span class="o">=</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">V_r</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">S_r_inv</span> <span class="o">@</span> <span class="n">W_r</span>  <span class="c1"># DMD modes</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">lambda_vals_current</span> <span class="o">=</span> <span class="n">D</span>  <span class="c1"># discrete-time eigenvalues</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">omega_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">lambda_vals_current</span><span class="p">)</span> <span class="o">/</span> <span class="n">dt</span>  <span class="c1"># continuous-time eigenvalue</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="c1"># Compute DMD mode amplitudes b</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">X1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">b_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Phi_current</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="c1"># DMD reconstruction for the current &#39;r&#39;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">mm1</span> <span class="o">=</span> <span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mm1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">time_dynamics_current</span> <span class="o">=</span> <span class="n">b_current</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">omega_current</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">Xdmd2_current</span> <span class="o">=</span> <span class="n">Phi_current</span> <span class="o">@</span> <span class="n">time_dynamics_current</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="c1"># Truncate to original number of variables (log-transformed)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">Xdmd_current_original_vars</span> <span class="o">=</span> <span class="n">Xdmd2_current</span><span class="p">[:</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="c1"># Calculate error (max absolute difference)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="c1"># Using original X (log-transformed) for comparison</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">current_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">Xdmd_current_original_vars</span><span class="p">))</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing r=</span><span class="si">{</span><span class="n">r_current</span><span class="si">}</span><span class="s2">: Max absolute error = </span><span class="si">{</span><span class="n">current_error</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">if</span> <span class="n">current_error</span> <span class="o">&lt;=</span> <span class="n">error_threshold</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">r_optimal</span> <span class="o">=</span> <span class="n">r_current</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="n">min_error</span> <span class="o">=</span> <span class="n">current_error</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="c1"># Store the results for the optimal r</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="n">best_Xdmd</span> <span class="o">=</span> <span class="n">Xdmd_current_original_vars</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="n">best_Phi</span> <span class="o">=</span> <span class="n">Phi_current</span><span class="p">[:</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># Truncate Phi to original variables</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="n">best_omega</span> <span class="o">=</span> <span class="n">omega_current</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="n">best_lambda_vals</span> <span class="o">=</span> <span class="n">lambda_vals_current</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="n">best_b</span> <span class="o">=</span> <span class="n">b_current</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="k">break</span>  <span class="c1"># Found the smallest r that satisfies the threshold</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="c1"># If we didn&#39;t meet the threshold, but this r gives the best error so far, keep its results</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="k">if</span> <span class="n">current_error</span> <span class="o">&lt;</span> <span class="n">min_error</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="n">min_error</span> <span class="o">=</span> <span class="n">current_error</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="n">r_optimal</span> <span class="o">=</span> <span class="n">r_current</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">best_Xdmd</span> <span class="o">=</span> <span class="n">Xdmd_current_original_vars</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">best_Phi</span> <span class="o">=</span> <span class="n">Phi_current</span><span class="p">[:</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">best_omega</span> <span class="o">=</span> <span class="n">omega_current</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="n">best_lambda_vals</span> <span class="o">=</span> <span class="n">lambda_vals_current</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">best_b</span> <span class="o">=</span> <span class="n">b_current</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal &#39;r&#39; determined: </span><span class="si">{</span><span class="n">r_optimal</span><span class="si">}</span><span class="s2"> (Max absolute error = </span><span class="si">{</span><span class="n">min_error</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="c1"># If no &#39;r&#39; met the threshold, use the one that gave the minimum error</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">if</span> <span class="n">best_Xdmd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># This should not happen if max_r_to_check &gt;= 1</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="c1"># Fallback to a default if no optimal r is found (e.g., r=1)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">r_optimal</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">U_r</span> <span class="o">=</span> <span class="n">U_full</span><span class="p">[:,</span> <span class="p">:</span><span class="n">r_optimal</span><span class="p">]</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">S_r_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">S_full</span><span class="p">[:</span><span class="n">r_optimal</span><span class="p">])</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="n">V_r</span> <span class="o">=</span> <span class="n">Vt_full</span><span class="p">[:</span><span class="n">r_optimal</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">Atilde</span> <span class="o">=</span> <span class="n">U_r</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">V_r</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">S_r_inv</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">D</span><span class="p">,</span> <span class="n">W_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Atilde</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">best_Phi</span> <span class="o">=</span> <span class="n">X2</span> <span class="o">@</span> <span class="n">V_r</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">S_r_inv</span> <span class="o">@</span> <span class="n">W_r</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">best_lambda_vals</span> <span class="o">=</span> <span class="n">D</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">best_omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">best_lambda_vals</span><span class="p">)</span> <span class="o">/</span> <span class="n">dt</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">x1</span> <span class="o">=</span> <span class="n">X1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">best_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">best_Phi</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">mm1</span> <span class="o">=</span> <span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mm1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">best_b</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">best_omega</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">best_Xdmd</span> <span class="o">=</span> <span class="p">(</span><span class="n">best_Phi</span> <span class="o">@</span> <span class="n">time_dynamics</span><span class="p">)[:</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="sa">f</span><span class="s2">&quot;Warning: No r met the threshold. Using r=</span><span class="si">{</span><span class="n">r_optimal</span><span class="si">}</span><span class="s2"> with max error </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">best_Xdmd</span><span class="p">))</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">return</span> <span class="n">best_Phi</span><span class="p">,</span> <span class="n">best_omega</span><span class="p">,</span> <span class="n">best_lambda_vals</span><span class="p">,</span> <span class="n">best_b</span><span class="p">,</span> <span class="n">best_Xdmd</span><span class="p">,</span> <span class="n">S_full</span><span class="p">,</span> <span class="n">r_optimal</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.SLM.augment_data_multiple_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">augment_data_multiple_columns</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Augment the data matrix X with nonlinear terms for multiple variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data matrix where each row is a variable, and each column 
is a snapshot in time.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>augmented_X</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The augmented data matrix with nonlinear terms.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/SLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">augment_data_multiple_columns</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Augment the data matrix X with nonlinear terms for multiple variables.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        X (np.ndarray): The data matrix where each row is a variable, and each column </span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            is a snapshot in time.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        augmented_X (np.ndarray): The augmented data matrix with nonlinear terms.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">n_variables</span><span class="p">,</span> <span class="n">n_snapshots</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="c1"># Calculate the number of augmented terms</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">num_augmented_terms</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">combinations_with_replacement</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_variables</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="c1"># Pre-allocate the augmented matrix</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">augmented_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="p">(</span><span class="n">n_variables</span> <span class="o">+</span> <span class="n">num_augmented_terms</span><span class="p">,</span> <span class="n">n_snapshots</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">augmented_X</span><span class="p">[:</span><span class="n">n_variables</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">X</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="c1"># Add quadratic terms and cross-products</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">row_idx</span> <span class="o">=</span> <span class="n">n_variables</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations_with_replacement</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_variables</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">augmented_X</span><span class="p">[</span><span class="n">row_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">row_idx</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="k">return</span> <span class="n">augmented_X</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.SLM.solve_tov" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_tov</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parametric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mseos</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Solves the TOV equation and returns radius, mass and central pressure</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fileName</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filename containing the EOS in the format nb (fm^-3),
E (MeV), P (MeV/fm^3)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dataArray</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data array containing radii, central pressure
and mass.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/SLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="k">def</span><span class="w"> </span><span class="nf">solve_tov</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parametric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mseos</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Solves the TOV equation and returns radius, mass and central pressure</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        fileName (str): Filename containing the EOS in the format nb (fm^-3),</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            E (MeV), P (MeV/fm^3)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        dataArray (array): Data array containing radii, central pressure</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            and mass.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Get current paths from the config module</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">paths</span> <span class="o">=</span> <span class="n">get_paths</span><span class="p">()</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="n">eos_file_path</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">tov_path_target</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">if</span> <span class="n">parametric</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="c1"># Access EOS_Data as package resource</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="n">slm_package_base</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="n">_SLM_PACKAGE_NAME</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="c1"># Get a Path-like object to the EOS_Data file within the installed package</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">eos_file_path</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="n">_INTERNAL_EOS_DATA_PATH</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="n">fileName</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="n">eos_data_resource_dir</span> <span class="o">=</span> <span class="n">slm_package_base</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;EOS_Data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="n">eos_file_path</span> <span class="o">=</span> <span class="n">eos_data_resource_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="c1"># When passing to TOV, ensure it&#39;s a string path if the solver expects it</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="n">file</span> <span class="o">=</span> <span class="n">TOV</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">eos_file_path</span><span class="p">),</span> <span class="n">tidal</span><span class="o">=</span><span class="n">tidal</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">tov_path_target</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;tov_data_dir&quot;</span><span class="p">]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="sa">f</span><span class="s2">&quot;Internal EOS file &#39;</span><span class="si">{</span><span class="n">fileName</span><span class="si">}</span><span class="s2">&#39; not found in package data.&quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="c1"># Access EOS_files from external configured path</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">if</span> <span class="n">mseos</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="n">eos_file_path</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;mseos_path&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">fileName</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">tov_path_target</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;mseos_tov_path&quot;</span><span class="p">]</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="n">eos_file_path</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;qeos_path&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">fileName</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="n">tov_path_target</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;qeos_tov_path&quot;</span><span class="p">]</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Path:&quot;</span><span class="p">,</span> <span class="n">eos_file_path</span><span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">file</span> <span class="o">=</span> <span class="n">TOV</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">eos_file_path</span><span class="p">),</span> <span class="n">tidal</span><span class="o">=</span><span class="n">tidal</span><span class="p">)</span>  <span class="c1"># Pass as string path</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="c1"># Now tov_path_target is guaranteed to be assigned</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tov_path_target</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">tov_path_target</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">file</span><span class="o">.</span><span class="n">tov_routine</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R of 1.4 solar mass star: &quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">canonical_NS_radius</span><span class="p">())</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">dataArray</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">file</span><span class="o">.</span><span class="n">total_radius</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">file</span><span class="o">.</span><span class="n">total_pres_central</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">file</span><span class="o">.</span><span class="n">total_mass</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="p">]</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="k">if</span> <span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">dataArray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="c1"># dataArray.append(file.tidal_deformability.flatten()[::-1])</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">dataArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dataArray</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="c1"># Construct the output filename more robustly</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">name_parts</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Name parts:&quot;</span><span class="p">,</span> <span class="n">name_parts</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">output_file_name</span> <span class="o">=</span> <span class="s2">&quot;MR_&quot;</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">output_file_name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;MR&quot;</span><span class="p">,</span> <span class="n">name_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;TOV&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="c1"># Save directly to the target path without changing directory</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="n">output_full_path</span> <span class="o">=</span> <span class="n">tov_path_target</span> <span class="o">/</span> <span class="n">output_file_name</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">output_full_path</span><span class="p">,</span> <span class="n">dataArray</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%1.8e</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="k">return</span> <span class="n">dataArray</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_if_no_docstring: true
members: true</p>
<h2 id="module-cleandata">Module: cleanData</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator.cleanData"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="slmemulator.cleanData.clean_directory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clean_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Cleans up specified files and directories within a given directory.</p>
        <p>directory (str): The path to the directory to clean. Defaults to the
                 current working directory if None.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/cleanData.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="k">def</span><span class="w"> </span><span class="nf">clean_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Cleans up specified files and directories within a given directory.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    directory (str): The path to the directory to clean. Defaults to the</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">                     current working directory if None.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="c1"># Ensure the target directory exists and is a directory</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">target_dir_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_dir_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Directory &#39;</span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">&#39; not found or is not a directory.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="k">return</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cleaning directory: </span><span class="si">{</span><span class="n">target_dir_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="c1"># List of additional folders created by the code that you want to remove recursively.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="c1"># These are now relative to the &#39;directory&#39; argument.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">additional_folders_to_clean_names</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">DEFAULT_EOS_FILES_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">DEFAULT_RESULTS_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">DEFAULT_TOV_DATA_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">DEFAULT_TEST_DATA_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">DEFAULT_TRAIN_DATA_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">DEFAULT_PLOTS_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="p">]</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="c1"># Convert these names to full paths within the target directory</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">additional_folders_to_clean_paths</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">target_dir_path</span> <span class="o">/</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">additional_folders_to_clean_names</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="p">]</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">target_dir_path</span><span class="p">,</span> <span class="n">topdown</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="p">):</span>  <span class="c1"># Traverse from bottom to top</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="c1"># Clean files matching patterns in cleanup_targets</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="k">for</span> <span class="n">target_ext</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cleanup_targets</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="p">]:</span>  <span class="c1"># Only check extensions</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">target_ext</span><span class="p">):</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="c1"># Clean directories matching patterns in cleanup_targets (by name)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="c1"># or directories matching full paths in additional_folders_to_clean_paths</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">for</span> <span class="n">dir_name</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="n">dir_full_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">/</span> <span class="n">dir_name</span>  <span class="c1"># Use Path for comparison</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="n">dir_name</span> <span class="ow">in</span> <span class="n">cleanup_targets</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                <span class="ow">or</span> <span class="n">dir_full_path</span> <span class="ow">in</span> <span class="n">additional_folders_to_clean_paths</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="p">):</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing directory: </span><span class="si">{</span><span class="n">dir_full_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">dir_full_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_if_no_docstring: true
members: true</p>
<h2 id="module-config">Module: config</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator.config"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="slmemulator.config.get_paths" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_paths</span><span class="p">(</span><span class="n">output_base_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">use_mseos</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">is_parametric_run</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns a dictionary of resolved paths for data input/output and other project directories.
Prioritizes explicit arguments for output_base_dir, then sensible defaults.
Conditionally sets 'current' EOS/TOV/results paths based on the use_mseos flag.
Adjusts base for general data directories (EOS_Data, TOV_data, testData, trainData)
to output_base_dir if provided (for local working directories),
otherwise defaults them to be under src_dir (for package internal use).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_base_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory for all generated outputs.
                             Defaults to the project root.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_mseos</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, 'current' paths will point to MSEOS-related directories.
              If False, 'current' paths will point to QEOS-related directories.
              Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_parametric_run</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, indicates a parametric run.
                      This parameter is available for future path logic,
                      but currently the primary factor for
                      data directory location is <code>output_base_dir</code>.
                      Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing all relevant path configurations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_paths</span><span class="p">(</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">output_base_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">use_mseos</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">is_parametric_run</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Returns a dictionary of resolved paths for data input/output and other project directories.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Prioritizes explicit arguments for output_base_dir, then sensible defaults.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Conditionally sets &#39;current&#39; EOS/TOV/results paths based on the use_mseos flag.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Adjusts base for general data directories (EOS_Data, TOV_data, testData, trainData)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    to output_base_dir if provided (for local working directories),</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    otherwise defaults them to be under src_dir (for package internal use).</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        output_base_dir (Path, optional): The base directory for all generated outputs.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">                                         Defaults to the project root.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        use_mseos (bool): If True, &#39;current&#39; paths will point to MSEOS-related directories.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">                          If False, &#39;current&#39; paths will point to QEOS-related directories.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">                          Defaults to True.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        is_parametric_run (bool): If True, indicates a parametric run.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">                                  This parameter is available for future path logic,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">                                  but currently the primary factor for</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">                                  data directory location is `output_base_dir`.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">                                  Defaults to True.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        dict: A dictionary containing all relevant path configurations.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="c1"># Use explicit output_base_dir or default to the calculated PROJECT_ROOT</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">output_base</span> <span class="o">=</span> <span class="n">output_base_dir</span> <span class="ow">or</span> <span class="n">PROJECT_ROOT</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="c1"># src_dir will always be under the primary base (output_base or PROJECT_ROOT)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">src_dir</span> <span class="o">=</span> <span class="n">output_base</span> <span class="o">/</span> <span class="n">DEFAULT_SRC_SUBDIR_NAME</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="c1"># Determine the base for general data directories (EOS_Data, TOV_data, testData, trainData)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="c1"># If output_base_dir is explicitly provided, these data directories should be</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="c1"># relative to it. Otherwise, they remain within the src_dir of the package.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">if</span> <span class="n">output_base_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">data_root_dir</span> <span class="o">=</span> <span class="n">output_base</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">data_root_dir</span> <span class="o">=</span> <span class="n">src_dir</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">paths</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="s2">&quot;project_root&quot;</span><span class="p">:</span> <span class="n">output_base</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="s2">&quot;src_dir&quot;</span><span class="p">:</span> <span class="n">src_dir</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="c1"># EOS_Codes_dir should point to the location within the *installed package*</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="c1"># This ensures that whether installed or in editable mode, it finds the right place.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="s2">&quot;eos_codes_dir&quot;</span><span class="p">:</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="s2">&quot;slmemulator&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="n">DEFAULT_EOS_CODES_SUBDIR_NAME</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="p">),</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="s2">&quot;plots_dir&quot;</span><span class="p">:</span> <span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_PLOTS_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="s2">&quot;results_dir&quot;</span><span class="p">:</span> <span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_RESULTS_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="s2">&quot;docs_dir&quot;</span><span class="p">:</span> <span class="n">output_base</span> <span class="o">/</span> <span class="n">DEFAULT_DOCS_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="s2">&quot;tests_dir&quot;</span><span class="p">:</span> <span class="n">output_base</span> <span class="o">/</span> <span class="n">DEFAULT_TESTS_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="s2">&quot;tutorials_dir&quot;</span><span class="p">:</span> <span class="n">output_base</span> <span class="o">/</span> <span class="n">DEFAULT_TUTORIALS_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="c1"># Data directories whose location depends on `output_base_dir`</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="s2">&quot;eos_data_dir&quot;</span><span class="p">:</span> <span class="n">data_root_dir</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="o">/</span> <span class="n">DEFAULT_EOS_DATA_SUBDIR_NAME</span><span class="p">,</span>  <span class="c1"># For user-provided/existing EOS data</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="s2">&quot;tov_data_dir&quot;</span><span class="p">:</span> <span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_TOV_DATA_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="s2">&quot;test_data_dir&quot;</span><span class="p">:</span> <span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_TEST_DATA_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="s2">&quot;train_path&quot;</span><span class="p">:</span> <span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_TRAIN_DATA_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="c1"># EOS_files_dir contains generated EOS files (MSEOS/QEOS subdirs)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="c1"># This is where output of MSEOS.py/Quarkyonia.py goes, typically under src/</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="s2">&quot;eos_files_dir&quot;</span><span class="p">:</span> <span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_EOS_FILES_SUBDIR_NAME</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="s2">&quot;eos_data_dir&quot;</span><span class="p">:</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="s2">&quot;slmemulator&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">DEFAULT_EOS_DATA_SUBDIR_NAME</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="p">),</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="c1"># Specific paths for QEOS and MSEOS (always defined relative to their respective bases)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="s2">&quot;qeos_path_specific&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_EOS_FILES_SUBDIR_NAME</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;QEOS&quot;</span><span class="p">,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="s2">&quot;mseos_path_specific&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_EOS_FILES_SUBDIR_NAME</span><span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="o">/</span> <span class="s2">&quot;MSEOS&quot;</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="c1"># Correcting specific TOV data paths to use data_root_dir (for user data)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="s2">&quot;qeos_tov_path_specific&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_TOV_DATA_SUBDIR_NAME</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="o">/</span> <span class="s2">&quot;QEOS&quot;</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="s2">&quot;mseos_tov_path_specific&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_TOV_DATA_SUBDIR_NAME</span><span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="o">/</span> <span class="s2">&quot;MSEOS&quot;</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="c1"># General SLM specific result/plot subdirectories (non-parametric)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="s2">&quot;slm_res_mseos_specific&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="n">data_root_dir</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="o">/</span> <span class="n">DEFAULT_RESULTS_SUBDIR_NAME</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="o">/</span> <span class="s2">&quot;MSEOS&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="o">/</span> <span class="n">DEFAULT_SLM_SUBDIR_NAME</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="p">),</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="s2">&quot;slm_res_qeos_specific&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="n">data_root_dir</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="o">/</span> <span class="n">DEFAULT_RESULTS_SUBDIR_NAME</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="o">/</span> <span class="s2">&quot;QEOS&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="o">/</span> <span class="n">DEFAULT_SLM_SUBDIR_NAME</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="p">),</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="s2">&quot;slm_plots_mseos_specific&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">data_root_dir</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="o">/</span> <span class="n">DEFAULT_PLOTS_SUBDIR_NAME</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="o">/</span> <span class="s2">&quot;MSEOS&quot;</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="o">/</span> <span class="n">DEFAULT_SLM_SUBDIR_NAME</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="p">),</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="s2">&quot;slm_plots_qeos_specific&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="n">data_root_dir</span> <span class="o">/</span> <span class="n">DEFAULT_PLOTS_SUBDIR_NAME</span> <span class="o">/</span> <span class="s2">&quot;QEOS&quot;</span> <span class="o">/</span> <span class="n">DEFAULT_SLM_SUBDIR_NAME</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="p">),</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="c1"># Parametric SLM specific result/plot subdirectories</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="s2">&quot;slm_res_mseos_parametric_specific&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="n">data_root_dir</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="o">/</span> <span class="n">DEFAULT_RESULTS_SUBDIR_NAME</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="o">/</span> <span class="s2">&quot;MSEOS&quot;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="o">/</span> <span class="n">DEFAULT_PSLM_SUBDIR_NAME</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="p">),</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="s2">&quot;slm_res_qeos_parametric_specific&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="n">data_root_dir</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="o">/</span> <span class="n">DEFAULT_RESULTS_SUBDIR_NAME</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="o">/</span> <span class="s2">&quot;QEOS&quot;</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="o">/</span> <span class="n">DEFAULT_PSLM_SUBDIR_NAME</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="p">),</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="s2">&quot;slm_plots_mseos_parametric_specific&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="n">data_root_dir</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="o">/</span> <span class="n">DEFAULT_PLOTS_SUBDIR_NAME</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="o">/</span> <span class="s2">&quot;MSEOS&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="o">/</span> <span class="n">DEFAULT_PSLM_SUBDIR_NAME</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="p">),</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="s2">&quot;slm_plots_qeos_parametric_specific&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">data_root_dir</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="o">/</span> <span class="n">DEFAULT_PLOTS_SUBDIR_NAME</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="o">/</span> <span class="s2">&quot;QEOS&quot;</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="o">/</span> <span class="n">DEFAULT_PSLM_SUBDIR_NAME</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="p">),</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="p">}</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="c1"># Conditionally set the &quot;current&quot; paths based on the use_mseos flag AND `is_parametric_run`</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">if</span> <span class="n">use_mseos</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_eos_input_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;mseos_path_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_tov_data_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;mseos_tov_path_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">if</span> <span class="n">is_parametric_run</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_slm_results_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="s2">&quot;slm_res_mseos_parametric_specific&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="p">]</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_slm_plots_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="s2">&quot;slm_plots_mseos_parametric_specific&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="p">]</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Non-parametric SLM run for MSEOS</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_slm_results_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;slm_res_mseos_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_slm_plots_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;slm_plots_mseos_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># QEOS</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_eos_input_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;qeos_path_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_tov_data_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;qeos_tov_path_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">if</span> <span class="n">is_parametric_run</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_slm_results_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;slm_res_qeos_parametric_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_slm_plots_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;slm_plots_qeos_parametric_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Non-parametric SLM run for QEOS</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_slm_results_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;slm_res_qeos_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;current_slm_plots_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s2">&quot;slm_plots_qeos_specific&quot;</span><span class="p">]</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="c1"># Ensure all paths are Path objects</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">paths</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_if_no_docstring: true
members: true</p>
<h2 id="module-pslm">Module: pSLM</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator.pSLM"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="slmemulator.pSLM.ParametricSLM" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ParametricSLM</span><span class="p">(</span><span class="n">fileList</span><span class="p">,</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">error_threshold</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">max_r</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">









                  <details class="quote">
                    <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">fileList</span><span class="p">,</span> <span class="n">filePath</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">error_threshold</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">max_r</span><span class="o">=</span><span class="kc">None</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="p">):</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="c1"># fileList is expected to be a list of Path objects from testpSLM.py</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fileList</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fileList</span><span class="p">]</span>  <span class="c1"># Ensure all are Path objects</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>  <span class="c1"># Ensure filePath is a Path object</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="o">=</span> <span class="n">tidal</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">error_threshold</span> <span class="o">=</span> <span class="n">error_threshold</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_r</span> <span class="o">=</span> <span class="n">max_r</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Number of quantities/rows in the data X</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mm1</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="kc">None</span>  <span class="c1"># Number of time points/columns in the data X (m-1 snapshots for DMD)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="c1"># Lists to store DMD components for each training file</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">D_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">b_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Store shapes (n, mm1) of training data</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="c1"># Store extracted parameters for each file, in the same order as fileList</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file_params</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">param_scaler</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Scaler for parameters, fitted in .fit()</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">scaled_params</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Scaled parameters of training data</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="slmemulator.pSLM.ParametricSLM.augment_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">augment_data</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Augments the input data X by adding quadratic terms (X_i * X_j).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Original data matrix (n, m).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray (np.ndarray): Augmented data matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="k">def</span><span class="w"> </span><span class="nf">augment_data</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Augments the input data X by adding quadratic terms (X_i * X_j).</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        X (np.ndarray): Original data matrix (n, m).</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        np.ndarray (np.ndarray): Augmented data matrix.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="c1"># Add quadratic terms (combinations with replacement of rows of X)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">combinations_with_replacement</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="c1"># Add cubic terms if needed (example commented out)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="c1"># for i, j, k in combinations_with_replacement(range(n), 3):</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="c1">#     out.append(X[i] * X[j] * X[k])</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.pSLM.ParametricSLM.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Fits the Parametric SLM model by processing each file in fileList,
performing DMD, and storing the DMD components along with extracted parameters.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    Fits the Parametric SLM model by processing each file in fileList,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">    performing DMD, and storing the DMD components along with extracted parameters.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">D_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">b_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file_params</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Reset for clarity, though init should handle it</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Store shapes for consistency check in predict</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">processed_files_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="k">for</span> <span class="n">file_path_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileList</span><span class="p">:</span>  <span class="c1"># Iterate through Path objects</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="c1"># Validate file_path_obj is a Path object and exists</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_path_obj</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">file_path_obj</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping invalid or non-existent file: </span><span class="si">{</span><span class="n">file_path_obj</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="k">continue</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="c1"># Extract parameters from the filename (e.g., TOV_MS_Ls_Lv_zeta_xi.txt)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="c1"># We assume the file name format is consistent with _extract_params_from_tov_filename</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="c1"># We determine mseos based on &#39;MS&#39; or &#39;QEOS&#39; in the filename</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">is_mseos</span> <span class="o">=</span> <span class="s2">&quot;MS&quot;</span> <span class="ow">in</span> <span class="n">file_path_obj</span><span class="o">.</span><span class="n">stem</span>  <span class="c1"># Check if filename contains &#39;MS&#39;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="c1"># Call the static method using self.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_params_from_tov_filename</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="n">file_path_obj</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="n">is_mseos</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># _extract_params_from_tov_filename prints warning</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="k">continue</span>  <span class="c1"># Skip if parameters could not be extracted</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="c1"># Load data from the file</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="c1"># The file is a Path object, np.loadtxt can directly handle it</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path_obj</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>                    <span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: contains NaN or Inf values. Please check data quality.&quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                <span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>                <span class="k">continue</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="c1"># Process data (assuming data has columns like Radius, Mass, etc.)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="c1"># X should be (num_quantities, num_points)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-9</span>  <span class="c1"># Small constant to prevent log(0)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>                <span class="c1"># Assuming 4 columns: Radius, Mass, Central Pressure, Tidal Deformability</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>                <span class="c1"># Ensure data has at least 4 columns</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>                    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>                        <span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Expected at least 4 columns for tidal data, got </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>                    <span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                <span class="c1"># Assuming 3 columns: Radius, Mass, Central Pressure (or other relevant)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>                <span class="c1"># Ensure data has at least 3 columns</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>                        <span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: Expected at least 3 columns for non-tidal data, got </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                    <span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>                <span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="p">)</span>  <span class="c1"># Ensure float64 for numerical stability</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="c1"># Store shape for consistency checks in predict</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="p">):</span>  <span class="c1"># Only set for the very first successfully processed file</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mm1</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">augmented_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment_data</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mm1</span><span class="p">))</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="k">elif</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="ow">or</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mm1</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                    <span class="sa">f</span><span class="s2">&quot;Warning: </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> has inconsistent shape </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">. Expected (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mm1</span><span class="si">}</span><span class="s2">). Skipping.&quot;</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>                <span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                <span class="k">continue</span>  <span class="c1"># Skip files with inconsistent shapes for DMD</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Assuming uniform time step of 1.0 between data points</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SLM_auto_r</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>  <span class="c1"># Perform SLM and get optimal rank</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="c1"># Check if SLM_auto_r returned a valid result</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;err&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">):</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                    <span class="sa">f</span><span class="s2">&quot;Failed to fit SLM model for </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">. Skipping.&quot;</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                <span class="k">continue</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="c1"># Store DMD components and parameters for successful fits</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Phi&quot;</span><span class="p">])</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">])</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">D_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">])</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">b_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">])</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">file_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>                <span class="n">params</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="p">)</span>  <span class="c1"># Store parameters for the processed file</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="p">)</span>  <span class="c1"># Store shape for this specific training data</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="n">processed_files_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="c1"># print(f&quot;Successfully processed {file_path_obj.name}. Max error: {result[&#39;err&#39;]:.4e}&quot;)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing file </span><span class="si">{</span><span class="n">file_path_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. Skipping.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="k">continue</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">if</span> <span class="n">processed_files_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="s2">&quot;No valid training files processed! Please check your input data and `error_threshold`.&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="c1"># Fit StandardScaler on the collected parameters</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_params</span><span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">param_scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">scaled_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.pSLM.ParametricSLM.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_interp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distance_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Predicts the dynamics (Xdmd) for a given set of parameters by finding nearest neighbors
in the parameter space and averaging their DMD components or using the closest one.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>param_values</code>
            </td>
            <td>
                  <code><span title="list">list</span> or <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list or array of parameter values to predict for
                                         (e.g., [Ls, Lv, zeta, xi] for MSEOS). This argument is mandatory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of nearest neighbors to use for prediction.
     Defaults to 1 (pure nearest neighbor).</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_interp</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, interpolate the final Xdmd outputs by averaging curves.
                  If False (default) and k&gt;1, averages the DMD components (Phi, omega, D, b).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distance_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the distance to the closest neighbor
                                  exceeds this threshold, a warning is printed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(Phi_avg/Phi_nn, omega_avg/omega_nn, D_avg/D_nn, b_avg/b_nn, Xdmd_predicted, t)
   - Reconstructed data (Xdmd_predicted) and related averaged DMD components.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Raises:
    ValueError: If the model has not been fitted or no training data is available.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_values</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_interp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distance_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">    Predicts the dynamics (Xdmd) for a given set of parameters by finding nearest neighbors</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">    in the parameter space and averaging their DMD components or using the closest one.</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        param_values (list or np.ndarray): A list or array of parameter values to predict for</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">                                                     (e.g., [Ls, Lv, zeta, xi] for MSEOS). This argument is mandatory.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        k (int): Number of nearest neighbors to use for prediction.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">                 Defaults to 1 (pure nearest neighbor).</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        output_interp (bool): If True, interpolate the final Xdmd outputs by averaging curves.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">                              If False (default) and k&gt;1, averages the DMD components (Phi, omega, D, b).</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        distance_threshold (float, optional): If the distance to the closest neighbor</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">                                              exceeds this threshold, a warning is printed.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        tuple: (Phi_avg/Phi_nn, omega_avg/omega_nn, D_avg/D_nn, b_avg/b_nn, Xdmd_predicted, t)</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">               - Reconstructed data (Xdmd_predicted) and related averaged DMD components.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        ValueError: If the model has not been fitted or no training data is available.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model not fitted. Call .fit() first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_params</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No training data parameters available from fit().&quot;</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="c1"># If param_values are provided (the main use case for prediction)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="c1"># Scale the input parameters using the fitted scaler</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">scaled_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">theta</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="sa">f</span><span class="s2">&quot;Parameter scaling failed for </span><span class="si">{</span><span class="n">theta</span><span class="si">}</span><span class="s2">. Ensure input matches training dimensions. Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="c1"># Calculate Euclidean distances to all scaled training parameters</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_params</span> <span class="o">-</span> <span class="n">scaled_theta</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="c1"># Get indices of k smallest distances</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="c1"># Ensure k does not exceed the number of available training samples</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">k_actual</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_params</span><span class="p">))</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">if</span> <span class="n">k_actual</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No training data available to make a prediction.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="n">idxs</span> <span class="o">=</span> <span class="n">sorted_indices</span><span class="p">[:</span><span class="n">k_actual</span><span class="p">]</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="c1"># Check if the closest neighbor is too far (optional warning/handling)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="k">if</span> <span class="n">distance_threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dists</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">distance_threshold</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="sa">f</span><span class="s2">&quot;Warning: Closest neighbor distance (</span><span class="si">{</span><span class="n">dists</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">) exceeds threshold (</span><span class="si">{</span><span class="n">distance_threshold</span><span class="si">}</span><span class="s2">). &quot;</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="sa">f</span><span class="s2">&quot;Prediction might be unreliable for parameters </span><span class="si">{</span><span class="n">param_values</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="c1"># Use the shape of the training data corresponding to the first nearest neighbor</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="c1"># as the reference shape for reconstruction (assuming consistency)</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span><span class="p">:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>            <span class="s2">&quot;Training data shapes not recorded during fit(). Cannot predict.&quot;</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="c1"># Use the original (non-augmented) shape of training data for reconstruction</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="n">ref_n_original</span><span class="p">,</span> <span class="n">ref_mm1_original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_data_shapes</span><span class="p">[</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="p">]</span>  <span class="c1"># Use shape from first nearest neighbor</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Assuming original dt=1.0</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">if</span> <span class="n">output_interp</span> <span class="ow">and</span> <span class="n">k_actual</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="c1"># Option 1: Interpolate outputs by averaging reconstructed curves</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="n">curves</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="n">Phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>            <span class="n">t_reconstruction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ref_mm1_original</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">b</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                <span class="n">omega</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">t_reconstruction</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="n">Xdmd_full_aug</span> <span class="o">=</span> <span class="n">Phi</span> <span class="o">@</span> <span class="n">time_dynamics</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="n">Xdmd</span> <span class="o">=</span> <span class="n">Xdmd_full_aug</span><span class="p">[</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                <span class="p">:</span><span class="n">ref_n_original</span><span class="p">,</span> <span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="p">]</span>  <span class="c1"># Trim back to original dimensions</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="n">curves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Xdmd</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">Xdmd_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">curves</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Average the reconstructed curves</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="c1"># For consistency, return averaged DMD components even if output is interpolated</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">Phi_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="n">omega_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">D_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">D_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="n">b_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">Phi_avg</span><span class="p">,</span> <span class="n">omega_avg</span><span class="p">,</span> <span class="n">D_avg</span><span class="p">,</span> <span class="n">b_avg</span><span class="p">,</span> <span class="n">Xdmd_predicted</span><span class="p">,</span> <span class="n">t_reconstruction</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="c1"># Option 2: Average DMD components (Phi, omega, D, b) from k nearest neighbors</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="c1"># (or just use the single nearest neighbor if k=1 or output_interp is False)</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">Phi_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Phi_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">omega_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">omega_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="n">D_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">D_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">b_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">b_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">t_reconstruction</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ref_mm1_original</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="p">)</span>  <span class="c1"># Time points for prediction</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">time_dynamics</span> <span class="o">=</span> <span class="n">b_avg</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="n">omega_avg</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">t_reconstruction</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="p">)</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="n">Xdmd_full_aug</span> <span class="o">=</span> <span class="n">Phi_avg</span> <span class="o">@</span> <span class="n">time_dynamics</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">Xdmd_predicted</span> <span class="o">=</span> <span class="n">Xdmd_full_aug</span><span class="p">[</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="p">:</span><span class="n">ref_n_original</span><span class="p">,</span> <span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="p">]</span>  <span class="c1"># Trim back to original dimensions</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">Phi_avg</span><span class="p">,</span> <span class="n">omega_avg</span><span class="p">,</span> <span class="n">D_avg</span><span class="p">,</span> <span class="n">b_avg</span><span class="p">,</span> <span class="n">Xdmd_predicted</span><span class="p">,</span> <span class="n">t_reconstruction</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="slmemulator.pSLM.is_on_boundary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_on_boundary</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">param_min</span><span class="p">,</span> <span class="n">param_max</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Checks if a parameter set is on the boundary of the parameter space.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/pSLM.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_on_boundary</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">param_min</span><span class="p">,</span> <span class="n">param_max</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if a parameter set is on the boundary of the parameter space.&quot;&quot;&quot;</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">)):</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="nb">abs</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">param_min</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tolerance</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">param_max</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tolerance</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="p">):</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_if_no_docstring: true
members: true</p>
<h2 id="module-recombination">Module: recombination</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator.recombination"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="slmemulator.recombination.gaussian_rbf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gaussian_rbf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Gaussian Radial Basis Function.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/recombination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">gaussian_rbf</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">):</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gaussian Radial Basis Function.&quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">epsilon</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.recombination.recombination_thinning" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">recombination_thinning</span><span class="p">(</span><span class="n">A_matrix</span><span class="p">,</span> <span class="n">y_vector</span><span class="p">,</span> <span class="n">initial_solution_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-09</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Conceptual implementation of the recombination thinning process based on the paper.
This function aims to find a sparse solution x' to the linear system Ax = y.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A_matrix</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix A in the linear system Ax = y.
                 In the context of GRIM, this matrix relates features and
                 linear functionals.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_vector</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The vector y in the linear system Ax = y.
                 In the context of GRIM, this relates to the target function
                 evaluated by linear functionals.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_solution_x</code>
            </td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An initial solution vector x. If None,
                                      a least squares solution is computed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tolerance</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tolerance for numerical stability, especially for SVD and
               checking non-zero components.</p>
              </div>
            </td>
            <td>
                  <code>1e-09</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.array: A sparser solution vector x' for the system Ax = y.
      Returns None if the system is inconsistent or other issues.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/recombination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">recombination_thinning</span><span class="p">(</span><span class="n">A_matrix</span><span class="p">,</span> <span class="n">y_vector</span><span class="p">,</span> <span class="n">initial_solution_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Conceptual implementation of the recombination thinning process based on the paper.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    This function aims to find a sparse solution x&#39; to the linear system Ax = y.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        A_matrix (np.array): The matrix A in the linear system Ax = y.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">                             In the context of GRIM, this matrix relates features and</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">                             linear functionals.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        y_vector (np.array): The vector y in the linear system Ax = y.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">                             In the context of GRIM, this relates to the target function</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">                             evaluated by linear functionals.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        initial_solution_x (np.array, optional): An initial solution vector x. If None,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">                                                  a least squares solution is computed.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        tolerance (float): Tolerance for numerical stability, especially for SVD and</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">                           checking non-zero components.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        np.array: A sparser solution vector x&#39; for the system Ax = y.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">                  Returns None if the system is inconsistent or other issues.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">if</span> <span class="n">A_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y_vector</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dimensions of A_matrix and y_vector are not compatible.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="c1"># 2. Find an initial solution x if not provided</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">if</span> <span class="n">initial_solution_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="n">initial_solution_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A_matrix</span><span class="p">,</span> <span class="n">y_vector</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="k">except</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span><span class="p">:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>                <span class="s2">&quot;Warning: Least squares solution failed for initial_solution_x. Returning None.&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="c1"># The `recombination_thinning` as provided aims to return an initial least squares solution.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="c1"># For more advanced thinning/sparsity, additional iterative logic or L1 regularization</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="c1"># would typically be integrated here. As per your provided `bgrim.py` and prior discussions,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="c1"># we are using this function&#39;s current behavior.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">return</span> <span class="n">initial_solution_x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_if_no_docstring: true
members: true</p>
<h2 id="module-scaledtov">Module: scaledTOV</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator.scaledTOV"></a>
    <div class="doc doc-contents first">

        <p>Information about the code:
This code solves TOV equations for mass radius relations. This can also plot the mass-radius curve.</p>
<p>USE: To use the code, here are the steps:
1) Include the file in your main code e.g. import tov_class as tc
2) Load the EoS using the ToV loader, tc.ToV(filename, arraysize)
3) call the solver as tc.ToV.mass_radius(min_pressure, max_pressure)
4) To plot, follow the code in main() on creating the dictionary of inputs</p>
<p>Updates: Version 0.0.1-1
Solves ToV, can only take inputs of pressure (MeV/fm^3), energy density in MeV, baryon density in fm^-3
in ascending order.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="slmemulator.scaledTOV.TOV" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TOV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">imax</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


        <p>Solves TOV equations and gives data-table, mass-radius plot and max. mass, central pressure
and central density by loading an EoS datafile.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/slmemulator/scaledTOV.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">imax</span><span class="p">):</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">e_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">eps0</span>  <span class="c1"># Scaled Energy density</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">pres0</span>  <span class="c1"># Scaled pressure</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">nb_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">imax</span> <span class="o">=</span> <span class="n">imax</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imax</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="slmemulator.scaledTOV.TOV.RK4" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">RK4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>A simple RK4 solver to avoid overhead of
calculating with solve_ivp or any other
adaptive step-size function.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.RK4(f=func, x0=1., t0=1., te=10., N=100)</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f</code>
            </td>
            <td>
                  <code><span title="func">func</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Python function for the ODE(s) to be solved.
Able to solve N coupled ODEs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guess for the function(s) to be solved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial point of the grid.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>te</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End point of the grid.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of steps to take in the range (te-t0).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>times</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The grid of solution steps.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>solution</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solutions of each function
at each point in the grid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/scaledTOV.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="k">def</span><span class="w"> </span><span class="nf">RK4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    A simple RK4 solver to avoid overhead of</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    calculating with solve_ivp or any other</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    adaptive step-size function.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        tov.RK4(f=func, x0=1., t0=1., te=10., N=100)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        f (func): A Python function for the ODE(s) to be solved.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            Able to solve N coupled ODEs.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        x0 (float): Guess for the function(s) to be solved.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        t0 (float): Initial point of the grid.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        te (float): End point of the grid.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        N (int): The number of steps to take in the range (te-t0).</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        times (array): The grid of solution steps.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        solution (array): The solutions of each function</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            at each point in the grid.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">te</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">te</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">solution</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">k1</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">k2</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k1</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">k3</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k2</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">k4</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.scaledTOV.TOV.baryon_from_energy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">baryon_from_energy</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate number density from energy using interpolation</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/scaledTOV.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="k">def</span><span class="w"> </span><span class="nf">baryon_from_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate number density from energy using interpolation&quot;&quot;&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">n1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">e_in</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_in</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="k">return</span> <span class="n">n1</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.scaledTOV.TOV.energy_from_pressure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">energy_from_pressure</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate energy density from pressure using interpolation</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/scaledTOV.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="k">def</span><span class="w"> </span><span class="nf">energy_from_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pressure</span><span class="p">):</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate energy density from pressure using interpolation&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">plow</span> <span class="o">=</span> <span class="mf">1e-10</span> <span class="o">/</span> <span class="n">pres0</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">if</span> <span class="n">pressure</span> <span class="o">&lt;</span> <span class="n">plow</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="k">return</span> <span class="mf">2.6e-310</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">e1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">p_in</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_in</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="k">return</span> <span class="n">e1</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.scaledTOV.TOV.pressure_from_energy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pressure_from_energy</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate pressure from energy density using interpolation</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/scaledTOV.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="k">def</span><span class="w"> </span><span class="nf">pressure_from_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate pressure from energy density using interpolation&quot;&quot;&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">e_in</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_in</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">return</span> <span class="n">p1</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.scaledTOV.TOV.pressure_from_nb" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pressure_from_nb</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate pressure from number density using interpolation</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/scaledTOV.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="k">def</span><span class="w"> </span><span class="nf">pressure_from_nb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb</span><span class="p">):</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate pressure from number density using interpolation&quot;&quot;&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nb_in</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_in</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">return</span> <span class="n">p1</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><p>options:
show_if_no_docstring: true
members: true</p>
<h2 id="module-scripts">Module: scripts</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator.scripts"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="slmemulator.scripts.curve_plus_bands_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">curve_plus_bands_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">color_68</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color_95</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zorder_c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Plot y vs. x with one sigma and two sigma bands based on std on axis ax.
 Add any other keyword pairs to style the main curve.</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/scripts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="k">def</span><span class="w"> </span><span class="nf">curve_plus_bands_plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">color_68</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color_95</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                          <span class="n">zorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zorder_c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    Plot y vs. x with one sigma and two sigma bands based on std on axis ax.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">     Add any other keyword pairs to style the main curve.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder_c</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">if</span> <span class="n">color_95</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">std</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">std</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">color_95</span><span class="p">,</span> 
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                        <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">if</span> <span class="n">color_68</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">std</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">std</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">color_68</span><span class="p">,</span> 
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                        <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.scripts.fermi_momentum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fermi_momentum</span><span class="p">(</span><span class="n">density</span><span class="p">,</span> <span class="n">degeneracy</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the Fermi momentum of infinite matter in inverse fermi</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>density</code>
            </td>
            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The density in inverse fermi^3</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>degeneracy</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The degeneracy factor g. 2 for pure neutron matter 
and 4 for symmetric matter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/scripts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="k">def</span><span class="w"> </span><span class="nf">fermi_momentum</span><span class="p">(</span><span class="n">density</span><span class="p">,</span> <span class="n">degeneracy</span><span class="p">):</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the Fermi momentum of infinite matter in inverse fermi</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Parameters:    </span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        density (array): The density in inverse fermi^3</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        degeneracy (int): The degeneracy factor g. 2 for pure neutron matter </span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            and 4 for symmetric matter.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">return</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">density</span> <span class="o">/</span> <span class="n">degeneracy</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.scripts.lighten_color" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lighten_color</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Lightens the given color by multiplying (1-luminosity) by the given amount.
Input can be matplotlib color string, hex string, or RGB tuple.</p>
<p>Examples:</p>
<blockquote>
<blockquote>
<p>lighten_color('g', 0.3)
lighten_color('#F034A3', 0.6)
lighten_color((.3,.55,.1), 0.5)</p>
</blockquote>
</blockquote>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/scripts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="k">def</span><span class="w"> </span><span class="nf">lighten_color</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Lightens the given color by multiplying (1-luminosity) by the given amount.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    Input can be matplotlib color string, hex string, or RGB tuple.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    &gt;&gt; lighten_color(&#39;g&#39;, 0.3)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    &gt;&gt; lighten_color(&#39;#F034A3&#39;, 0.6)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    &gt;&gt; lighten_color((.3,.55,.1), 0.5)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mc</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">colorsys</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">cnames</span><span class="p">[</span><span class="n">color</span><span class="p">]</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="k">except</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">color</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">colorsys</span><span class="o">.</span><span class="n">rgb_to_hls</span><span class="p">(</span><span class="o">*</span><span class="n">mc</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">return</span> <span class="n">colorsys</span><span class="o">.</span><span class="n">hls_to_rgb</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">amount</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="slmemulator.scripts.setup_rc_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setup_rc_params</span><span class="p">(</span><span class="n">presentation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Set matplotlib's rc parameters for the plots
Parameters:
    presentation (boolean): Increases font size (more readable) for talks if enabled</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/scripts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">setup_rc_params</span><span class="p">(</span><span class="n">presentation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set matplotlib&#39;s rc parameters for the plots</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        Parameters:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            presentation (boolean): Increases font size (more readable) for talks if enabled</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">if</span> <span class="n">presentation</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">9</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">black</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>  <span class="c1"># Set to defaults</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.edgecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">black</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="c1"># mpl.rcParams[&#39;axes.xmargin&#39;] = 0</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelcolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">black</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.direction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;in&#39;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">black</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">black</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="c1"># Make the ticks thin enough to not be visible at the limits of the plot (over the axes border)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.major.width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.linewidth&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.95</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.major.width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.linewidth&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.95</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="c1"># The minor ticks are little too small, make them both bigger.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.minor.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.4</span>  <span class="c1"># Default 2.0</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.minor.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.4</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.major.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.9</span>  <span class="c1"># Default 3.5</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.major.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.9</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">ppi</span> <span class="o">=</span> <span class="mi">72</span>  <span class="c1"># points per inch</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="c1"># dpi = 150</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># To show up reasonably in notebooks</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="c1"># 0.02 and 3 points are the defaults:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="c1"># can be changed on a plot-by-plot basis using fig.set_constrained_layout_pads()</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.wspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.hspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.h_pad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.</span> <span class="o">/</span> <span class="n">ppi</span>  <span class="c1"># 3 points</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.w_pad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.</span> <span class="o">/</span> <span class="n">ppi</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.title_fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fontsize</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.edgecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;inherit&#39;</span>  <span class="c1"># inherits from axes.edgecolor, to match</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>  <span class="c1"># Set facecolor with its own alpha, so edgecolor is unaffected</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fancybox&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.borderaxespad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.framealpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Do not set overall alpha (affects edgecolor). Handled by facecolor above</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;patch.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span>  <span class="c1"># This is for legend edgewidth, since it does not have its own option</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;hatch.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>options:
show_if_no_docstring: true
members: true</p>
<h2 id="module-tov_class">Module: TOV_class</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator.TOV_class"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="slmemulator.TOV_class.TOV" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TOV</span><span class="p">(</span><span class="n">eos_filepath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;RK4&#39;</span><span class="p">,</span> <span class="n">solve_ivp_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sol_pts</span><span class="o">=</span><span class="mi">4000</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


        <p>inertia using RK4. Also includes uncertainty quantification
techniques through the highest posterior density interval (HPD
or HDI) calculation. Able to accept one EOS from a single curve
or draws from an EOS, such as from a Gaussian Process.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov = TOVSolver(eos_filepath='path/to/eos', tidal=True, moment=True)</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>eos_filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the EOS data table to be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tidal</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to calculate tidal deformability or not.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>moment</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to calculate moment of inertia or not.
Default is False.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="quote">
                    <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">eos_filepath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;RK4&quot;</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">solve_ivp_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">sol_pts</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Class to calculate the Tolman-Oppenheimer-Volkoff equations,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    including options for the tidal deformability and moment of</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    inertia using RK4. Also includes uncertainty quantification</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    techniques through the highest posterior density interval (HPD</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    or HDI) calculation. Able to accept one EOS from a single curve</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    or draws from an EOS, such as from a Gaussian Process.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        tov = TOVSolver(eos_filepath=&#39;path/to/eos&#39;, tidal=True, moment=True)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        eos_filepath (str): The path to the EOS data table to be used.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        tidal (bool): Whether to calculate tidal deformability or not.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            Default is False.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        moment (bool): Whether to calculate moment of inertia or not.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            Default is False.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        None.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="c1"># assign class variables</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="o">=</span> <span class="n">tidal</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">=</span> <span class="n">solver</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sol_pts</span> <span class="o">=</span> <span class="n">sol_pts</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">solve_ivp_kwargs</span> <span class="o">=</span> <span class="n">solve_ivp_kwargs</span>  <span class="c1"># this is only used in solve_ivp</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span>  <span class="c1"># this is only used in solve_ivp</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="c1"># assign scaled variables</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">eps0</span> <span class="o">=</span> <span class="mf">1.285e3</span>  <span class="c1"># MeV fm-3</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">pres0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps0</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mass0</span> <span class="o">=</span> <span class="mf">2.837</span>  <span class="c1"># solar masses</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">rad0</span> <span class="o">=</span> <span class="mf">8.378</span>  <span class="c1"># km</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="c1"># load in the data (expects file with data headers for now)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">if</span> <span class="n">eos_filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">file_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_file_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">eos_filepath</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eos_name</span> <span class="o">=</span> <span class="p">(</span><span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="c1"># for data from compOSE</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_file_extension</span> <span class="o">==</span> <span class="s2">&quot;.table&quot;</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="c1"># extract from .table file</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">eos_file</span> <span class="o">=</span> <span class="n">eos_filepath</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="n">eos_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">eos_filepath</span><span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="c1"># check which column is which</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="k">if</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">eps_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps0</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres0</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">eps_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps0</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres0</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nB_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="k">if</span> <span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                <span class="n">dpdeps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_array</span><span class="p">,</span> <span class="n">edge_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cs2_array</span> <span class="o">=</span> <span class="n">dpdeps</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cs2_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span><span class="p">)])</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="c1"># keep unscaled for use in density calculation</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pres_array_unscaled</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="c1"># For data generated by codes</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_file_extension</span> <span class="o">==</span> <span class="s2">&quot;.dat&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_file_extension</span> <span class="o">==</span> <span class="s2">&quot;.txt&quot;</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="c1"># extract data and assign to arrays (assumes one sample/draw of EOS)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">eos_file</span> <span class="o">=</span> <span class="n">eos_filepath</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading EOS data from file: &quot;</span><span class="p">,</span> <span class="n">eos_filepath</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="n">eos_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">eos_filepath</span><span class="p">)</span>  <span class="c1"># , skiprows=2)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">eps_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps0</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres0</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nB_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">eos_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cs2_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cs2_array</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="c1"># keep unscaled for use in density calculation</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pres_array_unscaled</span> <span class="o">=</span> <span class="n">eos_data</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_file_extension</span> <span class="o">==</span> <span class="s2">&quot;.npz&quot;</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">eos_file</span> <span class="o">=</span> <span class="n">eos_filepath</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">eos_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">eos_filepath</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="c1"># assign to arrays based on header names</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">eps_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="p">[</span><span class="s2">&quot;edens&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps0</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="p">[</span><span class="s2">&quot;pres&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres0</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nB_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="p">[</span><span class="s2">&quot;density&quot;</span><span class="p">]</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cs2_array</span> <span class="o">=</span> <span class="n">eos_data</span><span class="p">[</span><span class="s2">&quot;cs2&quot;</span><span class="p">]</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="c1"># print congrats</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Woo it worked!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No file specified.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.RK2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">RK2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>A simple RK2 solver using the Heun's method.
This is a low-fidelity solver.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.RK2(f=func, x0=1., t0=1., te=10., N=100)</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f</code>
            </td>
            <td>
                  <code><span title="func">func</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Python function for the ODE(s) to be solved.
Able to solve N coupled ODEs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guess for the function(s) to be solved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial point of the grid.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>te</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End point of the grid.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of steps to take in the range (te-t0).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>times</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The grid of solution steps.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>solution</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solutions of each function
at each point in the grid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="k">def</span><span class="w"> </span><span class="nf">RK2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    A simple RK2 solver using the Heun&#39;s method.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    This is a low-fidelity solver.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        tov.RK2(f=func, x0=1., t0=1., te=10., N=100)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        f (func): A Python function for the ODE(s) to be solved.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            Able to solve N coupled ODEs.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        x0 (float): Guess for the function(s) to be solved.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        t0 (float): Initial point of the grid.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        te (float): End point of the grid.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        N (int): The number of steps to take in the range (te-t0).</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        times (array): The grid of solution steps.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        solution (array): The solutions of each function</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            at each point in the grid.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">te</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">te</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="n">solution</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">k1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="n">k2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">k1</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">x</span> <span class="o">+=</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="n">k2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.RK4" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">RK4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>A simple RK4 solver to avoid overhead of
calculating with solve_ivp or any other
adaptive step-size function.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.RK4(f=func, x0=1., t0=1., te=10., N=100)</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f</code>
            </td>
            <td>
                  <code><span title="func">func</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Python function for the ODE(s) to be solved.
Able to solve N coupled ODEs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guess for the function(s) to be solved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial point of the grid.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>te</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End point of the grid.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of steps to take in the range (te-t0).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>times</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The grid of solution steps.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>solution</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solutions of each function
at each point in the grid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="k">def</span><span class="w"> </span><span class="nf">RK4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    A simple RK4 solver to avoid overhead of</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    calculating with solve_ivp or any other</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    adaptive step-size function.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        tov.RK4(f=func, x0=1., t0=1., te=10., N=100)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        f (func): A Python function for the ODE(s) to be solved.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            Able to solve N coupled ODEs.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        x0 (float): Guess for the function(s) to be solved.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        t0 (float): Initial point of the grid.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        te (float): End point of the grid.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        N (int): The number of steps to take in the range (te-t0).</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        times (array): The grid of solution steps.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        solution (array): The solutions of each function</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            at each point in the grid.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">te</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">te</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">solution</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">k1</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">k2</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k1</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">k3</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k2</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">k4</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">6</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="n">solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.canonical_NS_radius" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">canonical_NS_radius</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculation of the radius of a 1.4 M_sol neutron star.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.canonical_NS_radius()</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rad_14</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of values of the radius
for each EOS used.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="k">def</span><span class="w"> </span><span class="nf">canonical_NS_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">    Calculation of the radius of a 1.4 M_sol neutron star.</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">        tov.canonical_NS_radius()</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">        None.</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">        rad_14 (array): The array of values of the radius</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">            for each EOS used.</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="c1"># interpolate the mass radius result?</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>    <span class="n">m_r_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span><span class="p">,</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_radius</span><span class="p">,</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>    <span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>    <span class="k">return</span> <span class="n">m_r_interp</span><span class="p">(</span><span class="mf">1.4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.central_dens" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">central_dens</span><span class="p">(</span><span class="n">pres_arr</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculation to determine the central density of the star
at the maximum mass and radius determined from the tov_routine().</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.central_dens()</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pres_arr</code>
            </td>
            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional pressure array to use for
calculating central densities at places other
than the absolute TOV maximum mass of each curve.
Default is None, and code will use absolute TOV
maximum mass central pressure class array.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>c_dens</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of central densities for
each EOS used.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="k">def</span><span class="w"> </span><span class="nf">central_dens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pres_arr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">    Calculation to determine the central density of the star</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">    at the maximum mass and radius determined from the tov_routine().</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">        tov.central_dens()</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">        pres_arr (array): An optional pressure array to use for</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">            calculating central densities at places other</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">            than the absolute TOV maximum mass of each curve.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">            Default is None, and code will use absolute TOV</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">            maximum mass central pressure class array.</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">        c_dens (array): The array of central densities for</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">            each EOS used.</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>    <span class="c1"># interpolate the EOS to find the proper central densities</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="n">p_n_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pres_array_unscaled</span><span class="p">,</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nB_array</span><span class="p">,</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>        <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">,</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>    <span class="p">)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>    <span class="c1"># solve at the proper central pressure for nB_central</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>    <span class="n">c_dens</span> <span class="o">=</span> <span class="n">p_n_interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_pres</span><span class="p">)</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>    <span class="k">return</span> <span class="n">c_dens</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.euler" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>A simple forward euler solver to avoid overhead of
calculating with solve_ivp or any other
adaptive step-size function.
This is a low fidelity solver!</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.euler(f=func, x0=1., t0=1., te=10., N=100)</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f</code>
            </td>
            <td>
                  <code><span title="func">func</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Python function for the ODE(s) to be solved.
Able to solve N coupled ODEs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guess for the function(s) to be solved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial point of the grid.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>te</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End point of the grid.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of steps to take in the range (te-t0).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>times</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The grid of solution steps.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>solution</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solutions of each function
at each point in the grid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="k">def</span><span class="w"> </span><span class="nf">euler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">te</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    A simple forward euler solver to avoid overhead of</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    calculating with solve_ivp or any other</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    adaptive step-size function.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    This is a low fidelity solver!</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        tov.euler(f=func, x0=1., t0=1., te=10., N=100)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        f (func): A Python function for the ODE(s) to be solved.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            Able to solve N coupled ODEs.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        x0 (float): Guess for the function(s) to be solved.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        t0 (float): Initial point of the grid.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        te (float): End point of the grid.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        N (int): The number of steps to take in the range (te-t0).</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        times (array): The grid of solution steps.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        solution (array): The solutions of each function</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            at each point in the grid.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">te</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">te</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="n">solution</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">x</span> <span class="o">+=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="n">solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.f_x" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">f_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">pres</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>A function in the tidal deformability calculation.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.f_x(x=0.2, mass=1.06, pres=2.34, eps=6.0)</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current gridpoint in scaled radius.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mass</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current mass.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pres</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current pressure from the EOS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eps</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current energy density from the EOS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value of F(x) at the current radius.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="k">def</span><span class="w"> </span><span class="nf">f_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">pres</span><span class="p">,</span> <span class="n">eps</span><span class="p">):</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    A function in the tidal deformability calculation.</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        tov.f_x(x=0.2, mass=1.06, pres=2.34, eps=6.0)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        x (float): The current gridpoint in scaled radius.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        mass (float): The current mass.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        pres (float): The current pressure from the EOS.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        eps (float): The current energy density from the EOS.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        The value of F(x) at the current radius.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="n">one</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">eps</span> <span class="o">-</span> <span class="n">pres</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">2.0</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">two</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">mass</span> <span class="o">/</span> <span class="n">x</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="k">return</span> <span class="n">one</span> <span class="o">/</span> <span class="n">two</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.max_arrays" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_arrays</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the max arrays needed for the interval calculation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>self.max_radius_arr (array): Maximum radius array.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>self.max_pres_arr (array): Maximum central pressure array.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>self.max_mass_arr (array): Maximum mass array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="k">def</span><span class="w"> </span><span class="nf">max_arrays</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">    Returns the max arrays needed for the interval calculation.</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">        None.</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">        self.max_radius_arr (array): Maximum radius array.</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">        self.max_pres_arr (array): Maximum central pressure array.</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">        self.max_mass_arr (array): Maximum mass array.</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_radius_arr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pres_arr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_mass_arr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.q_x" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">q_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">pres</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">cs2</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>A function in the calculation of the tidal deformability.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.q_x(x=0.1, mass=2.0, pres=1.0, eps=3.0, cs2=0.33)</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current gridpoint in scaled radius.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mass</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current mass.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pres</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current pressure from the EOS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eps</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current energy density from the EOS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cs2</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current speed of sound from the EOS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value of Q(x) at the current radius.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="k">def</span><span class="w"> </span><span class="nf">q_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">pres</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">cs2</span><span class="p">):</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    A function in the calculation of the tidal deformability.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        tov.q_x(x=0.1, mass=2.0, pres=1.0, eps=3.0, cs2=0.33)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        x (float): The current gridpoint in scaled radius.</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        mass (float): The current mass.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        pres (float): The current pressure from the EOS.</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        eps (float): The current energy density from the EOS.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        cs2 (float): The current speed of sound from the EOS.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        The value of Q(x) at the current radius.</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="n">pre</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">mass</span> <span class="o">/</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="n">one</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">eps</span> <span class="o">+</span> <span class="mf">9.0</span> <span class="o">*</span> <span class="n">pres</span> <span class="o">+</span> <span class="p">((</span><span class="n">eps</span> <span class="o">+</span> <span class="n">pres</span><span class="p">)</span> <span class="o">/</span> <span class="n">cs2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">/</span> <span class="n">x</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="n">two</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">+</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">pres</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="n">three</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">mass</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="k">return</span> <span class="n">pre</span> <span class="o">*</span> <span class="n">one</span> <span class="o">-</span> <span class="p">(</span><span class="n">two</span> <span class="o">/</span> <span class="n">three</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.tidal_def" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tidal_def</span><span class="p">(</span><span class="n">yR</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The calculation of the tidal deformability, Lambda, and
the tidal Love number, k2. This function is calculated after
the RK4 routine has been completed.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.tidal_def(yR=np.array, mass=np.array, radius=np.array)</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>yR</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of y at the maximum radii points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mass</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of mass at the maximum radii.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum radii array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tidal_deform</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tidal deformability solved at
each point in the maximum radius.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>k2</code></td>            <td>
                  <code><span title="array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value of the Love number calculated at the
compactness M/R and the value of y at maximum radius.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="k">def</span><span class="w"> </span><span class="nf">tidal_def</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yR</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    The calculation of the tidal deformability, Lambda, and</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    the tidal Love number, k2. This function is calculated after</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    the RK4 routine has been completed.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        tov.tidal_def(yR=np.array, mass=np.array, radius=np.array)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        yR (float): The array of y at the maximum radii points.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        mass (float): The array of mass at the maximum radii.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        radius (float): The maximum radii array.</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        tidal_deform (array): The tidal deformability solved at</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            each point in the maximum radius.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        k2 (array): The value of the Love number calculated at the</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            compactness M/R and the value of y at maximum radius.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="c1"># love number calculation</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="n">beta</span> <span class="o">=</span> <span class="p">(</span><span class="n">mass</span> <span class="o">/</span> <span class="n">radius</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rad0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass0</span><span class="p">))</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="n">k2</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="p">(</span><span class="mf">8.0</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="o">*</span> <span class="n">beta</span><span class="o">**</span><span class="mf">5.0</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">yR</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">yR</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="o">*</span> <span class="p">(</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="mf">2.0</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="mf">6.0</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">yR</span> <span class="o">+</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="mf">5.0</span> <span class="o">*</span> <span class="n">yR</span> <span class="o">-</span> <span class="mf">8.0</span><span class="p">))</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="o">+</span> <span class="mf">4.0</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="o">*</span> <span class="n">beta</span><span class="o">**</span><span class="mf">3.0</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="o">*</span> <span class="p">(</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                <span class="mf">13.0</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="o">-</span> <span class="mf">11.0</span> <span class="o">*</span> <span class="n">yR</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">yR</span> <span class="o">-</span> <span class="mf">2.0</span><span class="p">)</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">beta</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">yR</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="o">+</span> <span class="mf">3.0</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2.0</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">yR</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">yR</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="p">)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="c1"># tidal deformability calculation</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="n">tidal_deform</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass0</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rad0</span> <span class="o">*</span> <span class="n">mass</span><span class="p">))</span> <span class="o">**</span> <span class="mf">5.0</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="k">return</span> <span class="n">tidal_deform</span><span class="p">,</span> <span class="n">k2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.tov_equations_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tov_equations_scaled</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The Tolman-Oppenheimer-Volkoff equations in scaled format, to be
solved with the RK4 routine. If selected, the tidal deformability
and moment of inertia will be included and solved
simultaneously.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.tov_equations_scaled(x=0.2,
    y0=[m_init, p_init])</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A point in the scaled radius grid.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y0</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of initial guesses for each function
solved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solutions, in array format, of each function to be
solved.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="k">def</span><span class="w"> </span><span class="nf">tov_equations_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y0</span><span class="p">):</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    The Tolman-Oppenheimer-Volkoff equations in scaled format, to be</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    solved with the RK4 routine. If selected, the tidal deformability</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    and moment of inertia will be included and solved</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    simultaneously.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        tov.tov_equations_scaled(x=0.2,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            y0=[m_init, p_init])</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        x (float): A point in the scaled radius grid.</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        y0 (list): The list of initial guesses for each function</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">            solved.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        The solutions, in array format, of each function to be</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            solved.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="c1"># unpack the initial conditions</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">pres</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y0</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="n">cs2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cs2_interp</span><span class="p">(</span><span class="n">pres</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">pres</span><span class="p">,</span> <span class="n">mass</span> <span class="o">=</span> <span class="n">y0</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_interp</span><span class="p">(</span><span class="n">pres</span><span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="c1"># must also receive monotonically increasing P(n) results</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="k">if</span> <span class="n">pres</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="c1"># pressure equation</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="n">dpdx</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">pres</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">mass</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">pres</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">mass</span><span class="p">)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="c1"># mass equation</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">dmdx</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">eps</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="c1"># tidal deformability equation</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">pres</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">pres</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">cs2</span><span class="p">)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="n">dydx</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">f</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">dpdx</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="n">dmdx</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="n">dydx</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dpdx</span><span class="p">,</span> <span class="n">dmdx</span><span class="p">,</span> <span class="n">dydx</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dpdx</span><span class="p">,</span> <span class="n">dmdx</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.TOV_class.TOV.tov_routine" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tov_routine</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The TOV routine to solve each set of coupled ODEs and to output
the quantities needed to display the M-R curve, as well as the
tidal deformability and moment of inertia if desired.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>tov.tov_routine(verbose=True, write_to_file=True)</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to plot quantities and display
the full maximum mass array. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_to_file</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Choice to write the TOV results to
a file located in a folder of the user's choice.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>self.total_radius (array): The array of total maximum
radius values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>self.total_pres_central (array): The array of total
central pressure values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>self.total_max_mass (array): The array of total
maximum mass values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/TOV_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="k">def</span><span class="w"> </span><span class="nf">tov_routine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">write_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    The TOV routine to solve each set of coupled ODEs and to output</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">    the quantities needed to display the M-R curve, as well as the</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    tidal deformability and moment of inertia if desired.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        tov.tov_routine(verbose=True, write_to_file=True)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        verbose (bool): Whether to plot quantities and display</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            the full maximum mass array. Default is False.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        write_to_file (bool): Choice to write the TOV results to</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">            a file located in a folder of the user&#39;s choice.</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            Default is False.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        self.total_radius (array): The array of total maximum</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">            radius values.</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        self.total_pres_central (array): The array of total</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">            central pressure values.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        self.total_max_mass (array): The array of total</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">            maximum mass values.</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="c1"># list for storing results</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sols_varying_p0</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="c1"># initial pressure</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="n">pres_init</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span><span class="p">))</span>  <span class="c1"># Use np.max for clarity</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="n">mass_init</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">y_init</span> <span class="o">=</span> <span class="mf">2.0</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="c1"># set initial radius array</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="n">low_pres</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span><span class="p">))</span>  <span class="c1"># Use np.min for clarity</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="n">pres_space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">low_pres</span><span class="p">,</span> <span class="n">pres_init</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">pres_space</span> <span class="o">=</span> <span class="n">pres_space</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">yR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="c1"># set up arrays for the final results</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_pres_central</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="c1"># set up arrays (impermanent so this will work)</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="n">max_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="n">pres_central</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="n">max_radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="c1"># interpolate the energy density</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">eps_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eps_array</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cs2_interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pres_array</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cs2_array</span><span class="p">,</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="c1"># loop over the TOV equations</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">init_guess</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="c1"># initial conditions</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="n">mass_arg</span> <span class="o">=</span> <span class="n">mass_init</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="n">pres_arg</span> <span class="o">=</span> <span class="n">pres_space</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">init_guess</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pres_arg</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="n">init_guess</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mass_arg</span><span class="p">)</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="n">y_arg</span> <span class="o">=</span> <span class="n">y_init</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>            <span class="n">init_guess</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_arg</span><span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="c1"># Improve init_guess as one entry for all solutions</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="c1"># high fidelity (four function evals per sol_pt)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">==</span> <span class="s2">&quot;RK4&quot;</span><span class="p">:</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>            <span class="n">xval</span><span class="p">,</span> <span class="n">sol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RK4</span><span class="p">(</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tov_equations_scaled</span><span class="p">,</span> <span class="n">init_guess</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_pts</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>            <span class="p">)</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="c1"># low fidelity (two function evals per sol_pt)</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">==</span> <span class="s2">&quot;RK2&quot;</span><span class="p">:</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="n">xval</span><span class="p">,</span> <span class="n">sol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RK2</span><span class="p">(</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tov_equations_scaled</span><span class="p">,</span> <span class="n">init_guess</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_pts</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="p">)</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="c1"># low fidelity (one function eval per sol_pt)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">==</span> <span class="s2">&quot;euler&quot;</span><span class="p">:</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>            <span class="n">xval</span><span class="p">,</span> <span class="n">sol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">euler</span><span class="p">(</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tov_equations_scaled</span><span class="p">,</span> <span class="n">init_guess</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_pts</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>            <span class="p">)</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="c1"># adaptive (typically high fidelity)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">==</span> <span class="s2">&quot;solve_ivp&quot;</span><span class="p">:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_ivp_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">solve_ivp_kwargs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;RK45&quot;</span><span class="p">,</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                    <span class="s2">&quot;atol&quot;</span><span class="p">:</span> <span class="mf">5e-14</span><span class="p">,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>                    <span class="s2">&quot;rtol&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">,</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>                    <span class="s2">&quot;max_step&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>                    <span class="s2">&quot;dense_output&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                <span class="p">}</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>                <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">tov_equations_scaled</span><span class="p">,</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>                    <span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                    <span class="p">[</span><span class="n">pres_arg</span><span class="p">,</span> <span class="n">mass_arg</span><span class="p">,</span> <span class="n">y_arg</span><span class="p">],</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                    <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">solve_ivp_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                <span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">tov_equations_scaled</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                    <span class="p">[</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                    <span class="p">[</span><span class="n">pres_arg</span><span class="p">,</span> <span class="n">mass_arg</span><span class="p">],</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                    <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">solve_ivp_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                <span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">sol</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Solver failed.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                <span class="nb">print</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>            <span class="n">xval</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>            <span class="n">sol</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>                <span class="sa">f</span><span class="s1">&#39;Solver, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="si">}</span><span class="s1"> unknown. Must be &quot;RK4&quot;, &quot;RK2&quot;, &quot;euler&quot;, or &quot;solve_ivp&quot;.&#39;</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="p">)</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="c1"># maximum mass</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="c1"># Find the index where pressure becomes very small (approaching zero)</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="c1"># Use np.flatnonzero for more robust indexing</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="n">pressure_positive_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">)</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="k">if</span> <span class="n">pressure_positive_indices</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="n">index_mass</span> <span class="o">=</span> <span class="n">pressure_positive_indices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>            <span class="n">max_mass</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">index_mass</span><span class="p">]</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>            <span class="c1"># Handle cases where pressure never goes above threshold or immediately drops</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>            <span class="n">max_mass</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Or some other appropriate default</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>            <span class="c1"># print(f&quot;Warning: Pressure did not stay positive for central pressure {pres_arg}&quot;)</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="c1"># central pressure</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="n">pres_central</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="c1"># maximum radius</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="n">max_radius</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xval</span><span class="p">[</span><span class="n">index_mass</span><span class="p">]</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">index_mass</span><span class="p">]</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="c1"># Collect the results for each central pressure</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="n">solns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>            <span class="p">[</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>                <span class="n">xval</span><span class="p">[:</span> <span class="n">index_mass</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad0</span><span class="p">,</span>  <span class="c1"># radius</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>                <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span> <span class="n">index_mass</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres0</span><span class="p">,</span>  <span class="c1"># pressure</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>                <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span> <span class="n">index_mass</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass0</span><span class="p">,</span>  <span class="c1"># mass</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                <span class="n">sol</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span> <span class="n">index_mass</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>            <span class="p">],</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="p">)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sols_varying_p0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solns</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="c1"># scale results (send back totals at the end using these)</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>    <span class="n">max_mass</span> <span class="o">=</span> <span class="n">max_mass</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass0</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="n">max_radius</span> <span class="o">=</span> <span class="n">max_radius</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad0</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>    <span class="n">pres_central</span> <span class="o">=</span> <span class="n">pres_central</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres0</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span> <span class="o">=</span> <span class="n">max_mass</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_radius</span> <span class="o">=</span> <span class="n">max_radius</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_pres_central</span> <span class="o">=</span> <span class="n">pres_central</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="c1"># max mass calculation, radius, and central pressure</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">maximum_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">max_mass</span><span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>    <span class="n">corr_radius_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">max_mass</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_mass</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corr_radius</span> <span class="o">=</span> <span class="n">max_radius</span><span class="p">[</span><span class="n">corr_radius_index</span><span class="p">]</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">corr_pres</span> <span class="o">=</span> <span class="n">pres_central</span><span class="p">[</span><span class="n">corr_radius_index</span><span class="p">]</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>    <span class="c1"># save these results</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_mass_arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_mass</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_radius_arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_radius</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_pres_arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_pres</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="s2">&quot;Max mass: &quot;</span><span class="p">,</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">maximum_mass</span><span class="p">,</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="s2">&quot;Radius: &quot;</span><span class="p">,</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corr_radius</span><span class="p">,</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="s2">&quot;Central pressure: &quot;</span><span class="p">,</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corr_pres</span><span class="p">,</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>    <span class="p">)</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>    <span class="c1"># tidal deformability</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tidal_deformability</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal_def</span><span class="p">(</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">yR</span><span class="p">,</span> <span class="n">max_mass</span><span class="p">,</span> <span class="n">max_radius</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="p">)</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="c1"># print(</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="c1"># &quot;Tidal deformability at all points: {}&quot;.format(self.tidal_deformability)</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="c1"># )</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>        <span class="c1"># print(&quot;k2 at all points: {}&quot;.format(self.k2))</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>    <span class="k">if</span> <span class="n">verbose</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max mass array: &quot;</span><span class="p">,</span> <span class="n">max_mass</span><span class="p">)</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>        <span class="c1"># plot stuff</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_radius</span><span class="p">,</span> <span class="n">max_mass</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;TOV&quot;</span><span class="p">)</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="c1"># plt.plot(dense_rad, mrad_arr, label=r&#39;Interpolant&#39;)</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius [km]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Max Mass [M_solar]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_radius</span><span class="p">,</span> <span class="n">pres_central</span><span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius [km]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Central pressure [MeV/fm^3]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_mass</span> <span class="o">/</span> <span class="n">max_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yR</span><span class="p">)</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\beta$&quot;</span><span class="p">)</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;y(r)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;yr_scaled.png&quot;</span><span class="p">)</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>            <span class="c1"># fig = plt.figure(figsize=(8,6), dpi=200)</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal_deformability</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Radius&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Lambda(R)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;tidal.png&quot;</span><span class="p">)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="c1"># fig = plt.figure(figsize=(8,6), dpi=200)</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_mass</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal_deformability</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Mass [$M_{\odot}$]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Lambda(M)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;tidal_mass.png&quot;</span><span class="p">)</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="c1"># fig = plt.figure(figsize=(8,6), dpi=200)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_mass</span> <span class="o">/</span> <span class="n">max_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\beta$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$k_</span><span class="si">{2}</span><span class="s2">(\beta)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;k2.png&quot;</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="c1"># fig = plt.figure(figsize=(8,6), dpi=200)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$R$ [km]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$k_</span><span class="si">{2}</span><span class="s2">(R)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">9.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;k2R.png&quot;</span><span class="p">)</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="c1"># check the solution</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>            <span class="s2">&quot;Radius: &quot;</span><span class="p">,</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">corr_radius</span><span class="p">,</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="s2">&quot;Maximum mass: &quot;</span><span class="p">,</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">maximum_mass</span><span class="p">,</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>            <span class="s2">&quot;Central pressure: &quot;</span><span class="p">,</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">corr_pres</span><span class="p">,</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="p">)</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>    <span class="c1"># if desired, write to a file</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="k">if</span> <span class="n">write_to_file</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="n">tov_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">total_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_pres_central</span><span class="p">]</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="p">)</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>        <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;TOV_data/rpm_results&quot;</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_name</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;Radius[km] Mass[Msol] Central_Pressure[MeV/fm3]&quot;</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">tov_data</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">total_radius</span><span class="p">,</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">total_pres_central</span><span class="p">,</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span><span class="p">,</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tidal_deformability</span><span class="p">,</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="p">)</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_pres_central</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><p>options:
show_if_no_docstring: true
members: true</p>
<h2 id="module-tovscaledrev">Module: tovScaledRev</h2>


<div class="doc doc-object doc-module">



<a id="slmemulator.tovScaledRev"></a>
    <div class="doc doc-contents first">

        <p>Information about the code:
This code solves TOV equations for mass radius relations. This can also plot the mass-radius curve.</p>
<p>The code solves dr/dp and dm/dp instead of the regular way.</p>
<p>USE: To use the code, here are the steps:
1) Include the file in your main code e.g. import tov_class as tc
2) Load the EoS using the ToV loader, tc.ToV(filename, arraysize)
3) call the solver as tc.ToV.mass_radius(min_pressure, max_pressure)
4) To plot, follow the code in main() on creating the dictionary of inputs</p>
<p>Updates: Version 0.0.1-1
Solves ToV, can only take inputs of pressure (MeV/fm^3), energy density in MeV, baryon density in fm^-3
in ascending order.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="slmemulator.tovScaledRev.TOV" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TOV</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">imax</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">


        <p>Solves TOV equations and gives data-table, mass-radius plot and max. mass, central pressure
and central density by loading an EoS datafile.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/slmemulator/tovScaledRev.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">imax</span><span class="p">,</span> <span class="n">tidal</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span> <span class="o">=</span> <span class="n">tidal</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">e_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">eps0</span>  <span class="c1"># Scaled Energy density</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">pres0</span>  <span class="c1"># Scaled pressure</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">nb_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Scaled baryon density</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tidal</span><span class="p">:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cs2_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># sound speed</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">imax</span> <span class="o">=</span> <span class="n">imax</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imax</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="slmemulator.tovScaledRev.TOV.baryon_from_energy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">baryon_from_energy</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate number density from energy using interpolation</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/tovScaledRev.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="k">def</span><span class="w"> </span><span class="nf">baryon_from_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate number density from energy using interpolation&quot;&quot;&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">n1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">e_in</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_in</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">return</span> <span class="n">n1</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.tovScaledRev.TOV.energy_from_pressure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">energy_from_pressure</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate energy density from pressure using interpolation</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/tovScaledRev.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">def</span><span class="w"> </span><span class="nf">energy_from_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pressure</span><span class="p">):</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate energy density from pressure using interpolation&quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">plow</span> <span class="o">=</span> <span class="mf">1e-10</span> <span class="o">/</span> <span class="n">pres0</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">if</span> <span class="n">pressure</span> <span class="o">&lt;</span> <span class="n">plow</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="k">return</span> <span class="mf">2.6e-310</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">e1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">p_in</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_in</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="k">return</span> <span class="n">e1</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.tovScaledRev.TOV.pressure_from_energy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pressure_from_energy</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate pressure from energy density using interpolation</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/tovScaledRev.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="k">def</span><span class="w"> </span><span class="nf">pressure_from_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate pressure from energy density using interpolation&quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">e_in</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_in</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">return</span> <span class="n">p1</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="slmemulator.tovScaledRev.TOV.pressure_from_nb" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pressure_from_nb</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluate pressure from number density using interpolation</p>


            <details class="quote">
              <summary>Source code in <code>src/slmemulator/tovScaledRev.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="k">def</span><span class="w"> </span><span class="nf">pressure_from_nb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb</span><span class="p">):</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate pressure from number density using interpolation&quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">p1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nb_in</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_in</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="k">return</span> <span class="n">p1</span><span class="p">(</span><span class="n">nb</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><p>options:
show_if_no_docstring: true
members: true</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Sudhanva Lalit, Alexandra C. Semposki, and Joshua M. Maldonado. All rights reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.path", "toc.integrate", "search.highlight", "search.share", "search.suggest", "content.action.edit"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>